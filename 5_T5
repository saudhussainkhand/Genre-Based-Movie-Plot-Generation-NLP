{"cells":[{"cell_type":"markdown","source":["Mounting Drive and Importing Necessary Libraries"],"metadata":{"id":"tbxtG35s-XZW"}},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21295,"status":"ok","timestamp":1687100032242,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"7BkrOXbQ_622","outputId":"7882626c-7ffc-464e-ceef-d3280fabb070"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9,"status":"ok","timestamp":1687100196293,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"Cju2rEeWAEHS","outputId":"02fe821f-e30f-44fe-aed9-be09656e4c1f"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/Nuans_Project\n"]}],"source":["%cd \"drive/MyDrive/Nuans_Project\""]},{"cell_type":"markdown","source":["Note: To add data files and model files"],"metadata":{"id":"bw_hKoPpzmej"}},{"cell_type":"code","source":["'''!pip install gdown\n","import gdown\n","gdown.download_folder(\"https://drive.google.com/drive/folders/1-0Lx97H_kQwUOt2S-mn6WWPAtEnVPDBh?usp=sharing\")\n","gdown.download_folder(\"https://drive.google.com/drive/folders/1VDXdNiUAIc8oUBL6xOFuo3rmvDxPmKLY?usp=sharing\")\n","gdown.download_folder(\"https://drive.google.com/drive/folders/1YQIGMkdOU-eVktlWDLO2DG9n5hxCn84e?usp=sharing\")\n","gdown.download_folder(\"https://drive.google.com/drive/folders/1vZbBsCawST8jbPrC1YtFBzYM6ZJYhTJ4?usp=sharing\")\n","gdown.download_folder(\"https://drive.google.com/drive/folders/1y3_Cs-i3GgP5miS8g9Z7ThIqdEcmJbzm?usp=sharing\")\n","\n","gdown.download(\"https://drive.google.com/uc?id=1Xhj-xqBcfFkHnCmVhU0Co_j_hu2iDtgd\")\n","gdown.download(\"https://drive.google.com/uc?id=1nAlHbfr75o0qTSy4D_B1keMSuQCDzCcj\")\n","gdown.download(\"https://drive.google.com/uc?id=1pxNfiUjKMHxDbHFuCPNDg01aGo0l-Fya\")\n","gdown.download(\"https://drive.google.com/uc?id=1s5g6UPYVYRLhJI_KubDa__h12YfBh2yM\")'''"],"metadata":{"id":"UoQ35ovJzlNZ"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":213,"status":"ok","timestamp":1687100198160,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"dPHnJ-bYALNu","outputId":"feb904b0-0cf0-407d-abce-25da4151ce51"},"outputs":[{"output_type":"stream","name":"stdout","text":[" 6_genre_clean_training_data.txt   modelt524May\n"," 6_genre_eval_data.txt\t\t   modelt524May2nd\n"," BartFuzool\t\t\t   modelt524May3rd\n"," bart-large-cnn\t\t\t   modelt5trail1\n","'Cartella senza titolo'\t\t   new_model1gptneo\n"," cleaneddf.csv\t\t\t   new_model2gptneo\n"," data\t\t\t\t   new_model2gptneo23May\n"," DataPreprocessing.ipynb\t   new_model3gptneo\n"," dataset\t\t\t   new_model4gptneo\n"," drive\t\t\t\t   new_model4gptneo23May\n"," FAIRY_TALE\t\t\t   new-t5-source-target-data.pkl\n","'GPT2 Complete.ipynb'\t\t   outputBartVersion1\n"," gpt2Version1\t\t\t   outputT5\n"," GPTJFuzool\t\t\t   outputT5Cleaned\n"," GPT-Neo-Complete\t\t   outputT5Cleaned2\n"," model\t\t\t\t   t525May\n"," modelbarttrail1\t\t   T5SmallComplete.ipynb\n"," modelBARTtrail2\t\t   t5-source-target-data.pkl\n"," modelberttrail1\t\t   updated\n"," modelBloomtrail1\t\t   wiki_movie_plots_deduped.csv\n"," modelBloomTtrail1\t\t   wiki_movie_plots_deduped.gsheet\n"," modelOpttrail1\t\t\t   XLNETFUZOOL\n"," modelOptTtrail1\n"]}],"source":["!ls"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EqSMuL7rANjh"},"outputs":[],"source":["import os\n","import re\n","import pandas as pd\n","import numpy as np\n","import matplotlib.pyplot as plt\n","from tqdm import tqdm_notebook, tnrange\n","from sklearn.utils import shuffle\n","import pickle"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RcNdAToOATzp"},"outputs":[],"source":["def save_pickle(path, obj):\n","  with open(path, 'wb') as fp:\n","    pickle.dump(obj, fp)\n","def load_pickle(path):\n","  with open(path, 'rb') as fp:\n","    return pickle.load(fp)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9,"status":"ok","timestamp":1686054606407,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"PDFKv4uL0AL9","outputId":"faf45f9e-e5ab-47c7-eaa4-4b956b41ef34"},"outputs":[{"output_type":"stream","name":"stdout","text":[" 6_genre_clean_training_data.txt   modelt524May\n"," 6_genre_eval_data.txt\t\t   modelt524May2nd\n"," BartFuzool\t\t\t   modelt524May3rd\n"," bart-large-cnn\t\t\t   modelt5trail1\n","'Cartella senza titolo'\t\t   new_model1gptneo\n"," cleaneddf.csv\t\t\t   new_model2gptneo\n"," data\t\t\t\t   new_model2gptneo23May\n"," dataset\t\t\t   new_model3gptneo\n"," drive\t\t\t\t   new_model4gptneo\n"," FAIRY_TALE\t\t\t   new_model4gptneo23May\n"," GPTJFuzool\t\t\t   new-t5-source-target-data.pkl\n"," model\t\t\t\t   outputT5\n"," modelbarttrail1\t\t   outputT5Cleaned\n"," modelBARTtrail2\t\t   t525May\n"," modelberttrail1\t\t   t5-source-target-data.pkl\n"," modelBloomtrail1\t\t   updated\n"," modelBloomTtrail1\t\t   wiki_movie_plots_deduped.csv\n"," modelOpttrail1\t\t\t   wiki_movie_plots_deduped.gsheet\n"," modelOptTtrail1\t\t   XLNETFUZOOL\n"]}],"source":["!ls"]},{"cell_type":"markdown","source":["Loading Dataset"],"metadata":{"id":"klaJ7vWY-dib"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"RrEY9-I0Aaq_"},"outputs":[],"source":["movieDf = pd.read_csv('cleaneddf.csv')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":204},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1685711086805,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"2eTLVQlL0IHc","outputId":"10f86899-bb0c-4fc3-b912-7e66128ccb85"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-5ee2f409-5bf6-4fb5-8807-d2b4e21ebf25\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>index</th>\n","      <th>Genre</th>\n","      <th>Plot</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>comedy</td>\n","      <td>&lt;comedy&gt;The film is about a family who move to...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>14</td>\n","      <td>comedy</td>\n","      <td>&lt;comedy&gt;Before heading out to a baseball game ...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>15</td>\n","      <td>comedy</td>\n","      <td>&lt;comedy&gt;The plot is that of a black woman goin...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>16</td>\n","      <td>drama</td>\n","      <td>&lt;drama&gt;On a beautiful summer day a father and ...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>17</td>\n","      <td>drama</td>\n","      <td>&lt;drama&gt;A thug accosts a girl as she leaves her...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5ee2f409-5bf6-4fb5-8807-d2b4e21ebf25')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-5ee2f409-5bf6-4fb5-8807-d2b4e21ebf25 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-5ee2f409-5bf6-4fb5-8807-d2b4e21ebf25');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["   Unnamed: 0  index   Genre  \\\n","0           0      7  comedy   \n","1           1     14  comedy   \n","2           2     15  comedy   \n","3           3     16   drama   \n","4           4     17   drama   \n","\n","                                                Plot  \n","0  <comedy>The film is about a family who move to...  \n","1  <comedy>Before heading out to a baseball game ...  \n","2  <comedy>The plot is that of a black woman goin...  \n","3  <drama>On a beautiful summer day a father and ...  \n","4  <drama>A thug accosts a girl as she leaves her...  "]},"execution_count":8,"metadata":{},"output_type":"execute_result"}],"source":["movieDf.head()"]},{"cell_type":"markdown","source":["Creating new df, by inserting special token BOS in plots"],"metadata":{"id":"KNu45p9K-ghn"}},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":120,"referenced_widgets":["61cc194f57944f23aebb4bb4ac2d7551","01ca41e6a68c43e4b35c90944f1d3741","fbaaff705e2140e8b0e5e58b283b0ad0","301381b0bf7e4cc1be6f58ca657df16a","ceb9612f86c54e428bd2a43ce70c6ce8"]},"executionInfo":{"elapsed":2083,"status":"ok","timestamp":1685309209955,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"mPPxPAdl4rHQ","outputId":"1e2b6c86-0531-4a1e-cfda-925be9512ada"},"outputs":[{"name":"stderr","output_type":"stream","text":["<ipython-input-9-8020d39e4531>:2: TqdmDeprecationWarning: This function will be removed in tqdm==5.0.0\n","Please use `tqdm.notebook.tqdm` instead of `tqdm.tqdm_notebook`\n","  with tqdm_notebook(total = len(movieDf)) as pbar:\n"]},{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"61cc194f57944f23aebb4bb4ac2d7551","version_major":2,"version_minor":0},"text/plain":["  0%|          | 0/13622 [00:00<?, ?it/s]"]},"metadata":{},"output_type":"display_data"}],"source":["outputs = []\n","with tqdm_notebook(total = len(movieDf)) as pbar:\n","  for ix, row in movieDf.iterrows():\n","\n","    genre_to_plot_input = f'<BOS> <{row.Genre}>'\n","    genre_to_plot_output = row.Plot\n","    outputs.append({\n","        \"source\": genre_to_plot_input,\n","        \"target\": genre_to_plot_output\n","    })\n","\n","    pbar.update(1)"]},{"cell_type":"markdown","source":["for saving the new df"],"metadata":{"id":"-V6pXd1a-m9B"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"GBuwvz-fRVtw"},"outputs":[],"source":["#save_pickle('new-t5-source-target-data.pkl', outputs)"]},{"cell_type":"markdown","source":["Installing Rich and Transformers"],"metadata":{"id":"0V0_C8NZ-veo"}},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":20134,"status":"ok","timestamp":1687100225788,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"w658TZ06AcXd","outputId":"b171e61e-a785-448f-fabf-4a75f6d64783"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: rich in /usr/local/lib/python3.10/dist-packages (13.3.4)\n","Requirement already satisfied: markdown-it-py<3.0.0,>=2.2.0 in /usr/local/lib/python3.10/dist-packages (from rich) (2.2.0)\n","Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.10/dist-packages (from rich) (2.14.0)\n","Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.10/dist-packages (from markdown-it-py<3.0.0,>=2.2.0->rich) (0.1.2)\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: sentencepiece in /usr/local/lib/python3.10/dist-packages (0.1.99)\n"]}],"source":["!pip install rich\n","!pip install sentencepiece"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":20169,"status":"ok","timestamp":1687100245953,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"zAD0mQJcSBC5","outputId":"763602bd-e1bf-4cdb-e0d9-c4b4bca6106f"},"outputs":[{"output_type":"stream","name":"stdout","text":["Found existing installation: transformers 4.30.2\n","Uninstalling transformers-4.30.2:\n","  Successfully uninstalled transformers-4.30.2\n","Found existing installation: accelerate 0.20.3\n","Uninstalling accelerate-0.20.3:\n","  Successfully uninstalled accelerate-0.20.3\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers\n","  Using cached transformers-4.30.2-py3-none-any.whl (7.2 MB)\n","Collecting accelerate\n","  Using cached accelerate-0.20.3-py3-none-any.whl (227 kB)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.12.0)\n","Requirement already satisfied: huggingface-hub<1.0,>=0.14.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.15.1)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (1.22.4)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (23.1)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (6.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2022.10.31)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers) (2.27.1)\n","Requirement already satisfied: tokenizers!=0.11.3,<0.14,>=0.11.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.13.3)\n","Requirement already satisfied: safetensors>=0.3.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.3.1)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers) (4.65.0)\n","Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate) (5.9.5)\n","Requirement already satisfied: torch>=1.6.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (2.0.1+cu118)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers) (2023.4.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers) (4.5.0)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (1.11.1)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1.2)\n","Requirement already satisfied: triton==2.0.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (2.0.0)\n","Requirement already satisfied: cmake in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (3.25.2)\n","Requirement already satisfied: lit in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (16.0.5)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2022.12.7)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2.0.12)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.4)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.6.0->accelerate) (2.1.2)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch>=1.6.0->accelerate) (1.3.0)\n","Installing collected packages: transformers, accelerate\n","Successfully installed accelerate-0.20.3 transformers-4.30.2\n"]}],"source":["!pip uninstall -y transformers accelerate\n","!pip install transformers accelerate"]},{"cell_type":"markdown","source":["Importing other required libraries"],"metadata":{"id":"XRf889Ra-0Nm"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"c8yARDiQyzYy"},"outputs":[],"source":["import os\n","import re\n","import random\n","import pandas as pd\n","import numpy as np\n","import matplotlib.pyplot as plt\n","from tqdm import tqdm_notebook, tnrange\n","from sklearn.utils import shuffle\n","import pickle\n","import math\n","## use if working on jupyter notebook or colab\n","from IPython.display import clear_output"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"w8Xi6ZM1A7iC"},"outputs":[],"source":["import numpy as np\n","import torch\n","import torch.nn.functional as F\n","from torch.utils.data import Dataset, DataLoader\n","from transformers import T5Tokenizer, T5ForConditionalGeneration\n","from rich.table import Column, Table\n","from rich import box\n","from rich.console import Console\n","from torch import cuda\n","device = 'cuda' if cuda.is_available() else 'cpu'"]},{"cell_type":"markdown","source":["Defining logging console to save training and validation stats"],"metadata":{"id":"v8O_lWQk-3AP"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"rX6YnOVLTYbu"},"outputs":[],"source":["console = Console(record=True)\n","training_logger = Table(\n","    Column(\"Random Selection\", justify = \"center\"),\n","    Column(\"Epoch\", justify=\"center\"),\n","    Column(\"Loss\", justify=\"center\"),\n","    title=\"Training Status\",\n","    pad_edge=False,\n","    box=box.ASCII,\n",")\n","valid_loggger = Table(\n","    Column(\"Random Selection\", justify = \"center\"),\n","    Column(\"Loss\", justify = \"center\"),\n","    title=\"Validation Status\",\n","    pad_edge=False,\n","    box=box.ASCII,\n",")"]},{"cell_type":"markdown","source":["loading new df made above"],"metadata":{"id":"SynLpar--7qN"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"SV9PUHjzgNw5"},"outputs":[],"source":["data = load_pickle('new-t5-source-target-data.pkl')\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":10,"status":"ok","timestamp":1686054706927,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"8VnP8Ef1Ci3j","outputId":"38c3628a-a904-489c-9253-e5470aab50fa"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["13622"]},"metadata":{},"execution_count":13}],"source":["len(data)"]},{"cell_type":"markdown","source":["T5 Dataset Class to tokenizer the inputs"],"metadata":{"id":"okqs6Nih_CN_"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"hCRbbS4BLP8D"},"outputs":[],"source":["class T5Dataset(Dataset):\n","  def __init__(self, tokenizer, data, source_len, target_len):\n","    super(T5Dataset, self).__init__()\n","    self.tokenizer = tokenizer\n","    self.source_len = source_len\n","    self.target_len = target_len\n","    self.data = data\n","  def __len__(self):\n","    return len(self.data)\n","  def __getitem__(self, index):\n","    source_seq = self.data[index]['source']\n","    target_seq = self.data[index]['target']\n","    source = self.tokenizer.batch_encode_plus(\n","        [source_seq],\n","        max_length = self.source_len,\n","        pad_to_max_length = True,\n","        truncation = True,\n","        padding = \"max_length\",\n","        return_tensors = \"pt\"\n","    )\n","    target = self.tokenizer.batch_encode_plus(\n","        [target_seq],\n","        max_length = self.target_len,\n","        pad_to_max_length = True,\n","        truncation = True,\n","        padding = \"max_length\",\n","        return_tensors = \"pt\"\n","    )\n","    source_ids = source[\"input_ids\"].squeeze()\n","    source_mask = source[\"attention_mask\"].squeeze()\n","    target_ids = target[\"input_ids\"].squeeze()\n","    target_mask = target[\"attention_mask\"].squeeze()\n","    return {\n","        \"source_ids\": source_ids,\n","        \"source_mask\": source_mask,\n","        \"target_ids\": target_ids,\n","        \"target_mask\": target_mask\n","    }"]},{"cell_type":"markdown","source":["Train function"],"metadata":{"id":"J63cEryU_HPE"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"fAyaDAILLfkf"},"outputs":[],"source":["def train(epoch, tokenizer, model, device, loader, optimizer):\n","\n","    model.train()\n","\n","    total_loss = 0\n","    total_counts = 0\n","\n","    for _, data in enumerate(tqdm_notebook(loader, desc = \"Train DL\")):\n","\n","        y = data[\"target_ids\"].to(device, dtype = torch.long)\n","        y_ids = y[:, :-1].contiguous()\n","        lm_labels = y[:, 1:].clone().detach()\n","        lm_labels[y[:, 1:] == tokenizer.pad_token_id] = -100\n","        ids = data[\"source_ids\"].to(device, dtype = torch.long)\n","        mask = data[\"source_mask\"].to(device, dtype = torch.long)\n","\n","\n","        optimizer.zero_grad()\n","\n","        outputs = model(\n","            input_ids = ids, attention_mask = mask, decoder_input_ids = y_ids, labels = lm_labels\n","        )\n","\n","        loss = outputs[0]\n","\n","        total_counts += 1\n","        total_loss += loss.item()\n","\n","\n","        loss.backward()\n","        optimizer.step()\n","\n","\n","    # training_logger.add_row(str(epoch), str(f'{total_loss/total_counts}'))\n","    # console.log(training_logger)\n","\n","    return total_loss/total_counts"]},{"cell_type":"markdown","source":["Validation Function"],"metadata":{"id":"KhWmnbdW_Jou"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"obw2zNCjiuum"},"outputs":[],"source":["def validate(epoch, tokenizer, model, device, loader):\n","    model.eval()\n","    total_loss = 0\n","    total_counts = 0\n","    with torch.no_grad():\n","        for _, data in enumerate(tqdm_notebook(loader, desc = \"Valid DL\")):\n","            y = data[\"target_ids\"].to(device, dtype = torch.long)\n","            y_ids = y[:, :-1].contiguous()\n","            lm_labels = y[:, 1:].clone().detach()\n","            lm_labels[y[:, 1:] == tokenizer.pad_token_id] = -100\n","            ids = data[\"source_ids\"].to(device, dtype = torch.long)\n","            mask = data[\"source_mask\"].to(device, dtype = torch.long)\n","            outputs = model(\n","            input_ids = ids, attention_mask = mask, decoder_input_ids = y_ids, labels = lm_labels\n","            )\n","            loss = outputs[0]\n","            total_loss += loss.item()\n","            total_counts += 1\n","    return total_loss / total_counts"]},{"cell_type":"markdown","source":["For Loading Model, Tokenizer and saving training and validation results"],"metadata":{"id":"bHm763H0_T_9"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"IgNhzKnq-N13"},"outputs":[],"source":["def trainer(\n","    data, model_params, output_dir = \"outputT5Cleaned2/\"\n","):\n","    torch.manual_seed(model_params[\"SEED\"])\n","    torch.cuda.manual_seed(model_params[\"SEED\"])\n","    np.random.seed(model_params[\"SEED\"])\n","    torch.backends.cudnn.deterministic = True\n","\n","    console.log(f'''Model: Loading {model_params['MODEL']}.....''')\n","    tokenizer = T5Tokenizer.from_pretrained(model_params[\"MODEL\"])\n","    model = T5ForConditionalGeneration.from_pretrained(model_params[\"MODEL\"])\n","    model = model.to(device)\n","    console.log(f\"[DATA]: READING DATA.......\")\n","    optimizer = torch.optim.Adam(\n","        params=model.parameters(), lr=model_params[\"LEARNING_RATE\"]\n","    )\n","    # Training loop\n","    console.log(f\"[Initiating Fine Tuning]...\\\\n\")\n","    ## model save path\n","    path = os.path.join(output_dir, \"model_files\")\n","\n","    copyData = data.copy()\n","    copyData = shuffle(copyData)\n","\n","    train_size = 0.75\n","    random_permuts = np.random.permutation(len(copyData))\n","    train_nums = round(len(random_permuts) * train_size)\n","    train_dataset = [copyData[i] for i in random_permuts[:train_nums]]\n","    valid_dataset = [copyData[i] for i in random_permuts[train_nums:]]\n","    training_set = T5Dataset(\n","        tokenizer, train_dataset, model_params[\"MAX_SOURCE_TEXT_LENGTH\"], model_params[\"MAX_TARGET_TEXT_LENGTH\"]\n","    )\n","    val_set = T5Dataset(\n","        tokenizer, valid_dataset, model_params[\"MAX_SOURCE_TEXT_LENGTH\"], model_params[\"MAX_TARGET_TEXT_LENGTH\"]\n","    )\n","    train_params = {\n","        \"batch_size\": model_params[\"TRAIN_BATCH_SIZE\"],\n","        \"shuffle\": True,\n","        \"num_workers\": 0\n","    }\n","    val_params = {\n","        \"batch_size\": model_params[\"VALID_BATCH_SIZE\"],\n","        \"shuffle\": False,\n","        \"num_workers\": 0\n","    }\n","    prev_loss=[]\n","    train_dl = DataLoader(training_set, **train_params)\n","\n","    ## training\n","    console.log(f'[MODEL TRAINING]')\n","    clear_output(wait=True)\n","    for epoch in tnrange(model_params[\"TRAIN_EPOCHS\"], desc=\"Training\"):\n","        total_loss = train(epoch, tokenizer, model, device, train_dl, optimizer)\n","        training_logger.add_row(str(epoch), str(total_loss))\n","        console.log(training_logger)\n","        if epoch == 0:\n","            console.log(f\"Saving Model at epoch: {epoch} with total loss: {total_loss}\")\n","            model.save_pretrained(os.path.join(output_dir, \"model_files_initial\"))\n","            tokenizer.save_pretrained(os.path.join(output_dir, \"model_files_initial\"))\n","        if epoch > 0:\n","            #if min(prev_loss) > total_loss:\n","            console.log(f\"Saving Model at epoch: {epoch} with total loss: {total_loss}\")\n","            model.save_pretrained(path)\n","            tokenizer.save_pretrained(path)"]},{"cell_type":"markdown","source":["Model Training Parameters"],"metadata":{"id":"LHoIwozk_brK"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"LjSg9IyMObXj"},"outputs":[],"source":["model_params = {\n","    \"MODEL\": \"t5-base\", # if you have a bigger machine you can use t5-large\n","    \"TRAIN_BATCH_SIZE\": 2,\n","    \"VALID_BATCH_SIZE\": 2,\n","    \"TRAIN_EPOCHS\": 3,\n","    \"VAL_EPOCHS\": 3,\n","    \"LEARNING_RATE\": 1e-4,\n","    \"MAX_SOURCE_TEXT_LENGTH\": 128,\n","    \"MAX_TARGET_TEXT_LENGTH\": 786,\n","    \"SEED\": 3007,\n","    \"RANDOM_TRAIN_STEPS\": 0\n","}"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mSwX9HfaWDdI"},"outputs":[],"source":["#import os\n","#os.mkdir(\"outputT5Cleaned2\")"]},{"cell_type":"markdown","source":["Trainer object"],"metadata":{"id":"HR61mN7t_iql"}},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":634,"referenced_widgets":["da2c2d126bb240db90453c7e199b1407","0c155ece17c843f1855a92a4ecb4629e","63d1f4cd5d2a499fa2d7c29482d59b9a","ba6f0d94cfb04575a60916a66a631cdb","4c50b227e7dc45a4b5aef42952a367c9","a7c8c4714abf4fd09d2e81cb68dd847e","ab80c69711ef429198cb82e5e5370054","52ffcf90e113429eaa8008b557871636","1e681aba75ae4d24b7524e458edb75a2","ce756730b9564499ac5cf686b28a91b7","512f46370e1d4092b353103ced054757","7f60f1350daa4d079479f0b2a106d965","06fe5283432740c081aa1b929b957437","0a3e29a683c44b8dbde72d17323fb573","550bc15e65054009ac8b6d7a0ed6040a","3dbf1971b2954b1386bffe932a082e33","0cb608daacc34dc3b0a6e6aa1df4bdb8","dbf27f18235f4cdea671595df7301fa6","bfb49b85446c4589bcfb0c9724c0cd9c","191695c5915543a488e854e8495a20cc","638b8d7d699a451789332c6b1ee3b233","6c6935389d274e9b9a4d2f86c01fb66a","a194e8719448440094bb70ec4b52101d","729d677d8faf4218a3de3cef689ef161","b585c2c7a0684dcaaccd776b1dbe7440","61e599a22bf34408b8854eb87a1bc64c","1bc1cf9f799b4a86a40c4e983d63983d","0f75d0721ffc43d6ac11306061e17719","2dd0cff0cbdd4904bc28222de6ec2344","a294e8b4b5464628a9e63c9e5c15991c","8f08e3f44e7b44b9997597445eb9911e","76b9d3ae11344b61add05fefe3ba9c2b","f4c189ab1a564826a785f08bdad41336","27d5d4b89cd34d90990c8f5c5c488469","f4c344bb5dc8496ab4babca854990a40","e08b872b73bd4173b82dda1bc450ceeb","96c6941d604548b99c79563eeb153166","5bcf415a65964d0b8fe6e97084f3dbdc","f734773ab4d24726bfc8af9b69c1434b","226a18b8e6b24e0194acb09905eacb95","39fcc72b1737435a8f6cb56309f949e4","ad5580397edd4eb48898bdc187a6577d","0c2b6bd0e5cb44edae60cdda23eebcb3","8286964fdba84c2293ecad313b822c8a","ba54071a78a24259947870f90f507241","56163ecc94964049a4fcdbd3075cf666","ac3e834547c043b8b43b1a9312e3fffe","d30121e5d3b1457f89ce66e61f01525a","348d5f9f7ee34cafb5fa19659f3c6573","5669b24a8d6949a0a620913d5178fe53","f5647330a844409ca4bb34c47426839c","a0df829efdb244d1b4c50aee81a6e55f","07892f7e22b54c5fb93fac2c96015706","3b35a3afc21746978c9baae8688a0603","309dc28955284489b58fbe5a8027be34","e74ee1322c0544d2866bfd0b0d56efed","811badf4993c4ee8ac405e5276c5096f","00bb51ac689f4a29a4521f1d75174a87","859ee035919a4916b9ea9d165ebfd0a8","a37786af7162447e9e6f0ac26e9e3079","d8f59ea322c74a24abd6f77b37706482","c070614fac04495f91713bc1e0a614c7","d3e7cff7b2664b188a9f4621ebbc6723","7b65167588034e8f84e26b0678614e94","175ee1d9205b4006ba9b7bff8e323369","35f3d6bb071e41ca9b5b910674b96f83","c61aa968ebfb422c9c4fda9844a0438d","8608187cd2f44c76b70be3f9ad737be2","da252ff80a7848219d933cefbc7490d8","f04669c771f9433fb386d20fe2520bc9","8a82a9de6e9f40a7995fdcfec9348b86","ff43447d46e54c1daaba85c4c24fe92c","2964736a976348039d42abdae218f05e","0dfcd22b4ae3448aa3bbcdb6df5676f2","67c35f003c30400c803ac3c78a40904a","8c047387bc3f4a12b4a4f37e6605a924","f52274f601ce4093b435b93d9db6eab7","6bc2472a84624405b5a17b8d04461216","897b0f800b434701880f8003a7bbd604","00f8557ab2e34538af4d2469c8191378","2f44ef3fae294e9cb31097dcb220b8e1","d4458026c14e449e854bf37d4e367bbd","a4d08ee10556456cbac6fab5af51e84b","5f733061b4da4fecaa4479dc6dabce80","d1b607a3b10141bd8ac3659c265e6532","df09db31964549a6b34ff49b1e121a3b","492b556936244e12a7e8e2829e8aeac3","8184b1a1858c41e684ca3867e1ee13cb"]},"id":"8HACaNkQjRmF","executionInfo":{"status":"ok","timestamp":1686064454316,"user_tz":-120,"elapsed":9441018,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"3441ffea-4971-4c10-9024-f257b95e96dd"},"outputs":[{"output_type":"stream","name":"stderr","text":["<ipython-input-18-4265a7ed4579>:52: TqdmDeprecationWarning: Please use `tqdm.notebook.trange` instead of `tqdm.tnrange`\n","  for epoch in tnrange(model_params[\"TRAIN_EPOCHS\"], desc=\"Training\"):\n"]},{"output_type":"display_data","data":{"text/plain":["Training:   0%|          | 0/3 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"ba54071a78a24259947870f90f507241"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["<ipython-input-15-9c2e8c755559>:8: TqdmDeprecationWarning: This function will be removed in tqdm==5.0.0\n","Please use `tqdm.notebook.tqdm` instead of `tqdm.tqdm_notebook`\n","  for _, data in enumerate(tqdm_notebook(loader, desc = \"Train DL\")):\n"]},{"output_type":"display_data","data":{"text/plain":["Train DL:   0%|          | 0/5108 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e74ee1322c0544d2866bfd0b0d56efed"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[2;36m[13:29:27]\u001b[0m\u001b[2;36m \u001b[0m\u001b[3m               Training Status               \u001b[0m                         \u001b[2m<ipython-input-18-4265a7ed4579>\u001b[0m\u001b[2m:\u001b[0m\u001b[2m55\u001b[0m\n","\u001b[2;36m           \u001b[0m+-------------------------------------------+                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|\u001b[1mRandom Selection\u001b[0m\u001b[1m \u001b[0m|\u001b[1m \u001b[0m\u001b[1m      Epoch      \u001b[0m\u001b[1m \u001b[0m|\u001b[1m \u001b[0m\u001b[1mLoss\u001b[0m|                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|-----------------+-------------------+-----|                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|       0         | 3.725800872222464 |     |                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m+-------------------------------------------+                         \u001b[2m                                  \u001b[0m\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">[13:29:27] </span><span style=\"font-style: italic\">               Training Status               </span>                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">&lt;ipython-input-18-4265a7ed4579&gt;:55</span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>+-------------------------------------------+                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|<span style=\"font-weight: bold\">Random Selection </span>|<span style=\"font-weight: bold\">       Epoch       </span>|<span style=\"font-weight: bold\"> Loss</span>|                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|-----------------+-------------------+-----|                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|       0         | 3.725800872222464 |     |                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>+-------------------------------------------+                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[2;36m          \u001b[0m\u001b[2;36m \u001b[0mSaving Model at epoch: \u001b[1;36m0\u001b[0m with total loss: \u001b[1;36m3.725800872222464\u001b[0m           \u001b[2m<ipython-input-18-4265a7ed4579>\u001b[0m\u001b[2m:\u001b[0m\u001b[2m57\u001b[0m\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>Saving Model at epoch: <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> with total loss: <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.725800872222464</span>           <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">&lt;ipython-input-18-4265a7ed4579&gt;:57</span>\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Train DL:   0%|          | 0/5108 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"c61aa968ebfb422c9c4fda9844a0438d"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[2;36m[14:21:43]\u001b[0m\u001b[2;36m \u001b[0m\u001b[3m               Training Status               \u001b[0m                         \u001b[2m<ipython-input-18-4265a7ed4579>\u001b[0m\u001b[2m:\u001b[0m\u001b[2m55\u001b[0m\n","\u001b[2;36m           \u001b[0m+-------------------------------------------+                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|\u001b[1mRandom Selection\u001b[0m\u001b[1m \u001b[0m|\u001b[1m \u001b[0m\u001b[1m      Epoch      \u001b[0m\u001b[1m \u001b[0m|\u001b[1m \u001b[0m\u001b[1mLoss\u001b[0m|                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|-----------------+-------------------+-----|                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|       0         | 3.725800872222464 |     |                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|       1         | 3.466037342346732 |     |                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m+-------------------------------------------+                         \u001b[2m                                  \u001b[0m\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">[14:21:43] </span><span style=\"font-style: italic\">               Training Status               </span>                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">&lt;ipython-input-18-4265a7ed4579&gt;:55</span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>+-------------------------------------------+                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|<span style=\"font-weight: bold\">Random Selection </span>|<span style=\"font-weight: bold\">       Epoch       </span>|<span style=\"font-weight: bold\"> Loss</span>|                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|-----------------+-------------------+-----|                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|       0         | 3.725800872222464 |     |                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|       1         | 3.466037342346732 |     |                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>+-------------------------------------------+                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[2;36m          \u001b[0m\u001b[2;36m \u001b[0mSaving Model at epoch: \u001b[1;36m1\u001b[0m with total loss: \u001b[1;36m3.466037342346732\u001b[0m           \u001b[2m<ipython-input-18-4265a7ed4579>\u001b[0m\u001b[2m:\u001b[0m\u001b[2m62\u001b[0m\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>Saving Model at epoch: <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> with total loss: <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.466037342346732</span>           <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">&lt;ipython-input-18-4265a7ed4579&gt;:62</span>\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Train DL:   0%|          | 0/5108 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"6bc2472a84624405b5a17b8d04461216"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[2;36m[15:14:06]\u001b[0m\u001b[2;36m \u001b[0m\u001b[3m               Training Status                \u001b[0m                        \u001b[2m<ipython-input-18-4265a7ed4579>\u001b[0m\u001b[2m:\u001b[0m\u001b[2m55\u001b[0m\n","\u001b[2;36m           \u001b[0m+--------------------------------------------+                        \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|\u001b[1mRandom Selection\u001b[0m\u001b[1m \u001b[0m|\u001b[1m \u001b[0m\u001b[1m      Epoch       \u001b[0m\u001b[1m \u001b[0m|\u001b[1m \u001b[0m\u001b[1mLoss\u001b[0m|                        \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|-----------------+--------------------+-----|                        \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|       0         | 3.725800872222464  |     |                        \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|       1         | 3.466037342346732  |     |                        \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|       2         | 3.3664481703807527 |     |                        \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m+--------------------------------------------+                        \u001b[2m                                  \u001b[0m\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">[15:14:06] </span><span style=\"font-style: italic\">               Training Status                </span>                        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">&lt;ipython-input-18-4265a7ed4579&gt;:55</span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>+--------------------------------------------+                        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|<span style=\"font-weight: bold\">Random Selection </span>|<span style=\"font-weight: bold\">       Epoch        </span>|<span style=\"font-weight: bold\"> Loss</span>|                        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|-----------------+--------------------+-----|                        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|       0         | 3.725800872222464  |     |                        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|       1         | 3.466037342346732  |     |                        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|       2         | 3.3664481703807527 |     |                        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>+--------------------------------------------+                        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[2;36m          \u001b[0m\u001b[2;36m \u001b[0mSaving Model at epoch: \u001b[1;36m2\u001b[0m with total loss: \u001b[1;36m3.3664481703807527\u001b[0m          \u001b[2m<ipython-input-18-4265a7ed4579>\u001b[0m\u001b[2m:\u001b[0m\u001b[2m62\u001b[0m\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>Saving Model at epoch: <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span> with total loss: <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.3664481703807527</span>          <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">&lt;ipython-input-18-4265a7ed4579&gt;:62</span>\n","</pre>\n"]},"metadata":{}}],"source":["trainer(\n","    data = data,\n","    model_params = model_params,\n","    output_dir = \"outputT5Cleaned2\"\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pEkDIdX0yEu5"},"outputs":[],"source":["import os\n","import re\n","import random\n","import pandas as pd\n","import numpy as np\n","import matplotlib.pyplot as plt\n","from tqdm import tqdm_notebook, tnrange\n","from sklearn.utils import shuffle\n","import pickle\n","import math\n","import torch\n","import torch.nn.functional as F\n","from transformers import T5Tokenizer, T5ForConditionalGeneration"]},{"cell_type":"markdown","source":["Loading the saved tokenizer and Model"],"metadata":{"id":"doRAFWG3_ltz"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"W4Q92WWCO80J"},"outputs":[],"source":["torch.manual_seed(3007)\n","model = T5ForConditionalGeneration.from_pretrained('outputT5Cleaned2/model_files')\n","tokenizer = T5Tokenizer.from_pretrained('outputT5Cleaned2/model_files')"]},{"cell_type":"markdown","source":["Function to generate plots"],"metadata":{"id":"aogEkbpsHfuO"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"FY-yzCctWLMF"},"outputs":[],"source":["def generate_n_text_samples(model, tokenizer, input_text, device, n_samples):\n","    text_ids = tokenizer.encode(input_text, return_tensors = 'pt')\n","    text_ids = text_ids.to(device)\n","    model = model.to(device)\n","\n","    generated_text_samples = model.generate(\n","        text_ids,\n","        max_length= 200,\n","        num_return_sequences= n_samples,\n","        num_beams=n_samples+1,\n","        no_repeat_ngram_size= 2,\n","        repetition_penalty= 1.5,\n","        top_p= 0.92,\n","        temperature= .85,\n","        do_sample= True,\n","        top_k= 125,\n","        early_stopping= True\n","    )\n","    gen_text = []\n","    for t in generated_text_samples:\n","        text = tokenizer.decode(t, skip_special_tokens=True)\n","        gen_text.append(text)\n","        print(gen_text)\n","\n","        return gen_text\n"]},{"cell_type":"markdown","source":["function to calculate self-bleu score"],"metadata":{"id":"Kw1loj4tHg5L"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"Dgpaj8cw_CNb"},"outputs":[],"source":["import nltk\n","from nltk.translate.bleu_score import sentence_bleu\n","\n","def calculate_self_bleu(stories):\n","    self_bleu_scores = []\n","\n","    for story in stories:\n","        segments = story.split(\".\")  # Split the story into segments (e.g., by newline)\n","        #print(segments)\n","        bleu_scores = []\n","\n","        for i in range(len(segments)):\n","            reference = segments[:i] + segments[i+1:]  # Remove the current segment as reference\n","            #print(reference)\n","            hypothesis = segments[i]\n","            #print(hypothesis)\n","            bleu_scores.append(sentence_bleu(reference, hypothesis))\n","\n","        self_bleu_scores.append(sum(bleu_scores) / len(bleu_scores))\n","\n","    average_self_bleu = sum(self_bleu_scores) / len(self_bleu_scores)\n","    return average_self_bleu\n","\n"]},{"cell_type":"markdown","source":["Example Story 1 and Its score"],"metadata":{"id":"yWnjng3uC1g7"}},{"cell_type":"code","source":["input_prompt = \"<BOS><superhero> Once Upon a time\"\n","#input_text = tokenizer.bos_token\n","device = \"cuda:0\"\n","\n","headlines = generate_n_text_samples(model, tokenizer,\n","                                    input_prompt, device,n_samples = 1)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"QRBrB9MzXIVV","executionInfo":{"status":"ok","timestamp":1687100733433,"user_tz":-120,"elapsed":12899,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"78b255f3-07a0-4548-f3cb-233f525c3da1"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["['superhero>The film is set in a futuristic world, with the help of the superhuman Spyro. The film opens with an introduction to Superman and his powers.']\n"]}]},{"cell_type":"code","source":["# Example usage\n","generated_stories = headlines\n","#print(headlines)\n","self_bleu_score = calculate_self_bleu(generated_stories)\n","print(\"Self-BLEU score:\", self_bleu_score)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"KM0HmIcdA5iu","executionInfo":{"status":"ok","timestamp":1687100733433,"user_tz":-120,"elapsed":6,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"60da7b49-8775-4585-987d-78cf742e74cb"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Self-BLEU score: 0.18957668379316228\n"]}]},{"cell_type":"markdown","source":["Example Story 2 and Its Score"],"metadata":{"id":"NXTc2qAQC5YR"}},{"cell_type":"code","source":["input_prompt = \"<BOS><comedy> In a marriage ceremony\"\n","#input_text = tokenizer.bos_token\n","device = \"cuda:0\"\n","\n","headlines = generate_n_text_samples(model, tokenizer,\n","                                    input_prompt, device,n_samples = 1)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9owf2UGgXIRD","executionInfo":{"status":"ok","timestamp":1687100736174,"user_tz":-120,"elapsed":2744,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"cf2de8b2-658c-47cd-d434-4b12aa40f980"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[\"comedy>The film is about a young man who decides to marry his best friend, but she doesn't want to be involved in the marriage. He wants to get married to an attractive woman, so he goes to her home and tells her that she's having an affair with him.\"]\n"]}]},{"cell_type":"code","source":["# Example usage\n","generated_stories = headlines\n","#print(headlines)\n","self_bleu_score = calculate_self_bleu(generated_stories)\n","print(\"Self-BLEU score:\", self_bleu_score)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"hqSpTi44ClLD","executionInfo":{"status":"ok","timestamp":1687100743455,"user_tz":-120,"elapsed":8,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"9c5b633e-db6c-4b8a-b939-03de5bdfcab3"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Self-BLEU score: 0.1919008445165483\n"]}]},{"cell_type":"markdown","source":["Example Story 3 and Its score"],"metadata":{"id":"Btlf5BVJC8El"}},{"cell_type":"code","source":["input_prompt = \"<BOS><action> The drug mafia\"\n","#input_text = tokenizer.bos_token\n","device = \"cuda:0\"\n","\n","headlines = generate_n_text_samples(model, tokenizer,\n","                                    input_prompt, device,n_samples = 1)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Hvqe7a3zXIN-","executionInfo":{"status":"ok","timestamp":1687100757612,"user_tz":-120,"elapsed":2137,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"38bc8c95-a35d-474b-a30e-7f9678fc979d"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["['action>The film tells the story of a girl who falls in love with her father, and she is now married to an old man who lives in the suburbs of Mumbai. She works for reputed crime boss Priya (Prakash Raj), who is also the owner of the company. The film follows the life of two women who have been living in Mumbai for many years.[2]']\n"]}]},{"cell_type":"code","source":["# Example usage\n","generated_stories = headlines\n","#print(headlines)\n","self_bleu_score = calculate_self_bleu(generated_stories)\n","print(\"Self-BLEU score:\", self_bleu_score)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GzrddkjqA7Y5","executionInfo":{"status":"ok","timestamp":1687100759165,"user_tz":-120,"elapsed":206,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"5b24c43f-c04e-48b8-b3b2-da742c11de3e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Self-BLEU score: 0.3052655090131229\n"]}]},{"cell_type":"markdown","source":["END"],"metadata":{"id":"Hlz_JeUOC_bl"}}],"metadata":{"accelerator":"GPU","colab":{"provenance":[{"file_id":"1v61u9V2CPmWmOffYWnIWuPkxvNk7XttK","timestamp":1684368241793}],"authorship_tag":"ABX9TyPN8EM+yb7XkrlIgsKMqhKG"},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"61cc194f57944f23aebb4bb4ac2d7551":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_01ca41e6a68c43e4b35c90944f1d3741","IPY_MODEL_fbaaff705e2140e8b0e5e58b283b0ad0","IPY_MODEL_301381b0bf7e4cc1be6f58ca657df16a"],"layout":"IPY_MODEL_ceb9612f86c54e428bd2a43ce70c6ce8"}},"da2c2d126bb240db90453c7e199b1407":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_0c155ece17c843f1855a92a4ecb4629e","IPY_MODEL_63d1f4cd5d2a499fa2d7c29482d59b9a","IPY_MODEL_ba6f0d94cfb04575a60916a66a631cdb"],"layout":"IPY_MODEL_4c50b227e7dc45a4b5aef42952a367c9"}},"0c155ece17c843f1855a92a4ecb4629e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a7c8c4714abf4fd09d2e81cb68dd847e","placeholder":"​","style":"IPY_MODEL_ab80c69711ef429198cb82e5e5370054","value":"Downloading (…)ve/main/spiece.model: 100%"}},"63d1f4cd5d2a499fa2d7c29482d59b9a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_52ffcf90e113429eaa8008b557871636","max":791656,"min":0,"orientation":"horizontal","style":"IPY_MODEL_1e681aba75ae4d24b7524e458edb75a2","value":791656}},"ba6f0d94cfb04575a60916a66a631cdb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ce756730b9564499ac5cf686b28a91b7","placeholder":"​","style":"IPY_MODEL_512f46370e1d4092b353103ced054757","value":" 792k/792k [00:00&lt;00:00, 3.22MB/s]"}},"4c50b227e7dc45a4b5aef42952a367c9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a7c8c4714abf4fd09d2e81cb68dd847e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ab80c69711ef429198cb82e5e5370054":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"52ffcf90e113429eaa8008b557871636":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1e681aba75ae4d24b7524e458edb75a2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ce756730b9564499ac5cf686b28a91b7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"512f46370e1d4092b353103ced054757":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7f60f1350daa4d079479f0b2a106d965":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_06fe5283432740c081aa1b929b957437","IPY_MODEL_0a3e29a683c44b8dbde72d17323fb573","IPY_MODEL_550bc15e65054009ac8b6d7a0ed6040a"],"layout":"IPY_MODEL_3dbf1971b2954b1386bffe932a082e33"}},"06fe5283432740c081aa1b929b957437":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0cb608daacc34dc3b0a6e6aa1df4bdb8","placeholder":"​","style":"IPY_MODEL_dbf27f18235f4cdea671595df7301fa6","value":"Downloading (…)lve/main/config.json: 100%"}},"0a3e29a683c44b8dbde72d17323fb573":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_bfb49b85446c4589bcfb0c9724c0cd9c","max":1208,"min":0,"orientation":"horizontal","style":"IPY_MODEL_191695c5915543a488e854e8495a20cc","value":1208}},"550bc15e65054009ac8b6d7a0ed6040a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_638b8d7d699a451789332c6b1ee3b233","placeholder":"​","style":"IPY_MODEL_6c6935389d274e9b9a4d2f86c01fb66a","value":" 1.21k/1.21k [00:00&lt;00:00, 40.4kB/s]"}},"3dbf1971b2954b1386bffe932a082e33":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0cb608daacc34dc3b0a6e6aa1df4bdb8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dbf27f18235f4cdea671595df7301fa6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"bfb49b85446c4589bcfb0c9724c0cd9c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"191695c5915543a488e854e8495a20cc":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"638b8d7d699a451789332c6b1ee3b233":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6c6935389d274e9b9a4d2f86c01fb66a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a194e8719448440094bb70ec4b52101d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_729d677d8faf4218a3de3cef689ef161","IPY_MODEL_b585c2c7a0684dcaaccd776b1dbe7440","IPY_MODEL_61e599a22bf34408b8854eb87a1bc64c"],"layout":"IPY_MODEL_1bc1cf9f799b4a86a40c4e983d63983d"}},"729d677d8faf4218a3de3cef689ef161":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0f75d0721ffc43d6ac11306061e17719","placeholder":"​","style":"IPY_MODEL_2dd0cff0cbdd4904bc28222de6ec2344","value":"Downloading pytorch_model.bin: 100%"}},"b585c2c7a0684dcaaccd776b1dbe7440":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_a294e8b4b5464628a9e63c9e5c15991c","max":891691430,"min":0,"orientation":"horizontal","style":"IPY_MODEL_8f08e3f44e7b44b9997597445eb9911e","value":891691430}},"61e599a22bf34408b8854eb87a1bc64c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_76b9d3ae11344b61add05fefe3ba9c2b","placeholder":"​","style":"IPY_MODEL_f4c189ab1a564826a785f08bdad41336","value":" 892M/892M [00:10&lt;00:00, 171MB/s]"}},"1bc1cf9f799b4a86a40c4e983d63983d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0f75d0721ffc43d6ac11306061e17719":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2dd0cff0cbdd4904bc28222de6ec2344":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a294e8b4b5464628a9e63c9e5c15991c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8f08e3f44e7b44b9997597445eb9911e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"76b9d3ae11344b61add05fefe3ba9c2b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f4c189ab1a564826a785f08bdad41336":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"27d5d4b89cd34d90990c8f5c5c488469":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f4c344bb5dc8496ab4babca854990a40","IPY_MODEL_e08b872b73bd4173b82dda1bc450ceeb","IPY_MODEL_96c6941d604548b99c79563eeb153166"],"layout":"IPY_MODEL_5bcf415a65964d0b8fe6e97084f3dbdc"}},"f4c344bb5dc8496ab4babca854990a40":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f734773ab4d24726bfc8af9b69c1434b","placeholder":"​","style":"IPY_MODEL_226a18b8e6b24e0194acb09905eacb95","value":"Downloading (…)neration_config.json: 100%"}},"e08b872b73bd4173b82dda1bc450ceeb":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_39fcc72b1737435a8f6cb56309f949e4","max":147,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ad5580397edd4eb48898bdc187a6577d","value":147}},"96c6941d604548b99c79563eeb153166":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0c2b6bd0e5cb44edae60cdda23eebcb3","placeholder":"​","style":"IPY_MODEL_8286964fdba84c2293ecad313b822c8a","value":" 147/147 [00:00&lt;00:00, 9.78kB/s]"}},"5bcf415a65964d0b8fe6e97084f3dbdc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f734773ab4d24726bfc8af9b69c1434b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"226a18b8e6b24e0194acb09905eacb95":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"39fcc72b1737435a8f6cb56309f949e4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ad5580397edd4eb48898bdc187a6577d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0c2b6bd0e5cb44edae60cdda23eebcb3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8286964fdba84c2293ecad313b822c8a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ba54071a78a24259947870f90f507241":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_56163ecc94964049a4fcdbd3075cf666","IPY_MODEL_ac3e834547c043b8b43b1a9312e3fffe","IPY_MODEL_d30121e5d3b1457f89ce66e61f01525a"],"layout":"IPY_MODEL_348d5f9f7ee34cafb5fa19659f3c6573"}},"56163ecc94964049a4fcdbd3075cf666":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5669b24a8d6949a0a620913d5178fe53","placeholder":"​","style":"IPY_MODEL_f5647330a844409ca4bb34c47426839c","value":"Training: 100%"}},"ac3e834547c043b8b43b1a9312e3fffe":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_a0df829efdb244d1b4c50aee81a6e55f","max":3,"min":0,"orientation":"horizontal","style":"IPY_MODEL_07892f7e22b54c5fb93fac2c96015706","value":3}},"d30121e5d3b1457f89ce66e61f01525a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3b35a3afc21746978c9baae8688a0603","placeholder":"​","style":"IPY_MODEL_309dc28955284489b58fbe5a8027be34","value":" 3/3 [2:36:58&lt;00:00, 3140.33s/it]"}},"348d5f9f7ee34cafb5fa19659f3c6573":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5669b24a8d6949a0a620913d5178fe53":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f5647330a844409ca4bb34c47426839c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a0df829efdb244d1b4c50aee81a6e55f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"07892f7e22b54c5fb93fac2c96015706":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"3b35a3afc21746978c9baae8688a0603":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"309dc28955284489b58fbe5a8027be34":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e74ee1322c0544d2866bfd0b0d56efed":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_811badf4993c4ee8ac405e5276c5096f","IPY_MODEL_00bb51ac689f4a29a4521f1d75174a87","IPY_MODEL_859ee035919a4916b9ea9d165ebfd0a8"],"layout":"IPY_MODEL_a37786af7162447e9e6f0ac26e9e3079"}},"811badf4993c4ee8ac405e5276c5096f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d8f59ea322c74a24abd6f77b37706482","placeholder":"​","style":"IPY_MODEL_c070614fac04495f91713bc1e0a614c7","value":"Train DL: 100%"}},"00bb51ac689f4a29a4521f1d75174a87":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_d3e7cff7b2664b188a9f4621ebbc6723","max":5108,"min":0,"orientation":"horizontal","style":"IPY_MODEL_7b65167588034e8f84e26b0678614e94","value":5108}},"859ee035919a4916b9ea9d165ebfd0a8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_175ee1d9205b4006ba9b7bff8e323369","placeholder":"​","style":"IPY_MODEL_35f3d6bb071e41ca9b5b910674b96f83","value":" 5108/5108 [52:12&lt;00:00,  1.63it/s]"}},"a37786af7162447e9e6f0ac26e9e3079":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d8f59ea322c74a24abd6f77b37706482":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c070614fac04495f91713bc1e0a614c7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d3e7cff7b2664b188a9f4621ebbc6723":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7b65167588034e8f84e26b0678614e94":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"175ee1d9205b4006ba9b7bff8e323369":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"35f3d6bb071e41ca9b5b910674b96f83":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c61aa968ebfb422c9c4fda9844a0438d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_8608187cd2f44c76b70be3f9ad737be2","IPY_MODEL_da252ff80a7848219d933cefbc7490d8","IPY_MODEL_f04669c771f9433fb386d20fe2520bc9"],"layout":"IPY_MODEL_8a82a9de6e9f40a7995fdcfec9348b86"}},"8608187cd2f44c76b70be3f9ad737be2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ff43447d46e54c1daaba85c4c24fe92c","placeholder":"​","style":"IPY_MODEL_2964736a976348039d42abdae218f05e","value":"Train DL: 100%"}},"da252ff80a7848219d933cefbc7490d8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_0dfcd22b4ae3448aa3bbcdb6df5676f2","max":5108,"min":0,"orientation":"horizontal","style":"IPY_MODEL_67c35f003c30400c803ac3c78a40904a","value":5108}},"f04669c771f9433fb386d20fe2520bc9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8c047387bc3f4a12b4a4f37e6605a924","placeholder":"​","style":"IPY_MODEL_f52274f601ce4093b435b93d9db6eab7","value":" 5108/5108 [52:12&lt;00:00,  1.65it/s]"}},"8a82a9de6e9f40a7995fdcfec9348b86":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ff43447d46e54c1daaba85c4c24fe92c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2964736a976348039d42abdae218f05e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0dfcd22b4ae3448aa3bbcdb6df5676f2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"67c35f003c30400c803ac3c78a40904a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"8c047387bc3f4a12b4a4f37e6605a924":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f52274f601ce4093b435b93d9db6eab7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6bc2472a84624405b5a17b8d04461216":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_897b0f800b434701880f8003a7bbd604","IPY_MODEL_00f8557ab2e34538af4d2469c8191378","IPY_MODEL_2f44ef3fae294e9cb31097dcb220b8e1"],"layout":"IPY_MODEL_d4458026c14e449e854bf37d4e367bbd"}},"897b0f800b434701880f8003a7bbd604":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a4d08ee10556456cbac6fab5af51e84b","placeholder":"​","style":"IPY_MODEL_5f733061b4da4fecaa4479dc6dabce80","value":"Train DL: 100%"}},"00f8557ab2e34538af4d2469c8191378":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_d1b607a3b10141bd8ac3659c265e6532","max":5108,"min":0,"orientation":"horizontal","style":"IPY_MODEL_df09db31964549a6b34ff49b1e121a3b","value":5108}},"2f44ef3fae294e9cb31097dcb220b8e1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_492b556936244e12a7e8e2829e8aeac3","placeholder":"​","style":"IPY_MODEL_8184b1a1858c41e684ca3867e1ee13cb","value":" 5108/5108 [52:15&lt;00:00,  1.61it/s]"}},"d4458026c14e449e854bf37d4e367bbd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a4d08ee10556456cbac6fab5af51e84b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5f733061b4da4fecaa4479dc6dabce80":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d1b607a3b10141bd8ac3659c265e6532":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"df09db31964549a6b34ff49b1e121a3b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"492b556936244e12a7e8e2829e8aeac3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8184b1a1858c41e684ca3867e1ee13cb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat":4,"nbformat_minor":0}