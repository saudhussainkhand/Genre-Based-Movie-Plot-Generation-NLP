{"cells":[{"cell_type":"markdown","source":["Importing and Installing Necessary Libraries and Mounting Drive"],"metadata":{"id":"Mqar_af-DHfc"}},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17095,"status":"ok","timestamp":1687101428372,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"7BkrOXbQ_622","outputId":"46379afa-d393-4444-dafe-8f6b9364346f"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13,"status":"ok","timestamp":1687101428373,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"Cju2rEeWAEHS","outputId":"d64085f8-ae2a-4a02-f095-0335409c1c9d"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/Nuans_Project\n"]}],"source":["%cd \"drive/MyDrive/Nuans_Project\""]},{"cell_type":"markdown","source":["Note: To add data files and model files"],"metadata":{"id":"VSsS_38jzzhb"}},{"cell_type":"code","source":["'''!pip install gdown\n","import gdown\n","gdown.download_folder(\"https://drive.google.com/drive/folders/1-0Lx97H_kQwUOt2S-mn6WWPAtEnVPDBh?usp=sharing\")\n","gdown.download_folder(\"https://drive.google.com/drive/folders/1VDXdNiUAIc8oUBL6xOFuo3rmvDxPmKLY?usp=sharing\")\n","gdown.download_folder(\"https://drive.google.com/drive/folders/1YQIGMkdOU-eVktlWDLO2DG9n5hxCn84e?usp=sharing\")\n","gdown.download_folder(\"https://drive.google.com/drive/folders/1vZbBsCawST8jbPrC1YtFBzYM6ZJYhTJ4?usp=sharing\")\n","gdown.download_folder(\"https://drive.google.com/drive/folders/1y3_Cs-i3GgP5miS8g9Z7ThIqdEcmJbzm?usp=sharing\")\n","\n","gdown.download(\"https://drive.google.com/uc?id=1Xhj-xqBcfFkHnCmVhU0Co_j_hu2iDtgd\")\n","gdown.download(\"https://drive.google.com/uc?id=1nAlHbfr75o0qTSy4D_B1keMSuQCDzCcj\")\n","gdown.download(\"https://drive.google.com/uc?id=1pxNfiUjKMHxDbHFuCPNDg01aGo0l-Fya\")\n","gdown.download(\"https://drive.google.com/uc?id=1s5g6UPYVYRLhJI_KubDa__h12YfBh2yM\")'''"],"metadata":{"id":"VKqWZp69z0Ne"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":456,"status":"ok","timestamp":1687101428824,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"dPHnJ-bYALNu","outputId":"8b4439ba-313d-4df5-836e-fc7fa239f9f6"},"outputs":[{"output_type":"stream","name":"stdout","text":[" 6_genre_clean_training_data.txt   modelt524May\n"," 6_genre_eval_data.txt\t\t   modelt524May2nd\n"," BartFuzool\t\t\t   modelt524May3rd\n"," bart-large-cnn\t\t\t   modelt5trail1\n","'Cartella senza titolo'\t\t   new_model1gptneo\n"," cleaneddf.csv\t\t\t   new_model2gptneo\n"," data\t\t\t\t   new_model2gptneo23May\n"," DataPreprocessing.ipynb\t   new_model3gptneo\n"," dataset\t\t\t   new_model4gptneo\n"," drive\t\t\t\t   new_model4gptneo23May\n"," FAIRY_TALE\t\t\t   new-t5-source-target-data.pkl\n","'GPT2 Complete.ipynb'\t\t   outputBartVersion1\n"," gpt2Version1\t\t\t   outputT5\n"," GPTJFuzool\t\t\t   outputT5Cleaned\n"," GPT-Neo-Complete\t\t   outputT5Cleaned2\n"," model\t\t\t\t   t525May\n"," modelbarttrail1\t\t   T5SmallComplete.ipynb\n"," modelBARTtrail2\t\t   t5-source-target-data.pkl\n"," modelberttrail1\t\t   updated\n"," modelBloomtrail1\t\t   wiki_movie_plots_deduped.csv\n"," modelBloomTtrail1\t\t   wiki_movie_plots_deduped.gsheet\n"," modelOpttrail1\t\t\t   XLNETFUZOOL\n"," modelOptTtrail1\n"]}],"source":["!ls"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EqSMuL7rANjh"},"outputs":[],"source":["import os\n","import re\n","import pandas as pd\n","import numpy as np\n","import matplotlib.pyplot as plt\n","from tqdm import tqdm_notebook, tnrange\n","from sklearn.utils import shuffle\n","import pickle"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RcNdAToOATzp"},"outputs":[],"source":["def save_pickle(path, obj):\n","  with open(path, 'wb') as fp:\n","    pickle.dump(obj, fp)\n","def load_pickle(path):\n","  with open(path, 'rb') as fp:\n","    return pickle.load(fp)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9,"status":"ok","timestamp":1686918407450,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"PDFKv4uL0AL9","outputId":"2d017ff4-9cee-4162-ce65-64f6c7b3e483"},"outputs":[{"output_type":"stream","name":"stdout","text":[" 6_genre_clean_training_data.txt   modelt524May\n"," 6_genre_eval_data.txt\t\t   modelt524May2nd\n"," BartFuzool\t\t\t   modelt524May3rd\n"," bart-large-cnn\t\t\t   modelt5trail1\n","'Cartella senza titolo'\t\t   new_model1gptneo\n"," cleaneddf.csv\t\t\t   new_model2gptneo\n"," data\t\t\t\t   new_model2gptneo23May\n"," dataset\t\t\t   new_model3gptneo\n"," drive\t\t\t\t   new_model4gptneo\n"," FAIRY_TALE\t\t\t   new_model4gptneo23May\n","'GPT2 Complete.ipynb'\t\t   new-t5-source-target-data.pkl\n"," gpt2Version1\t\t\t   outputT5\n"," GPTJFuzool\t\t\t   outputT5Cleaned\n"," GPT-Neo-Complete\t\t   outputT5Cleaned2\n"," model\t\t\t\t   t525May\n"," modelbarttrail1\t\t   T5SmallComplete.ipynb\n"," modelBARTtrail2\t\t   t5-source-target-data.pkl\n"," modelberttrail1\t\t   updated\n"," modelBloomtrail1\t\t   wiki_movie_plots_deduped.csv\n"," modelBloomTtrail1\t\t   wiki_movie_plots_deduped.gsheet\n"," modelOpttrail1\t\t\t   XLNETFUZOOL\n"," modelOptTtrail1\n"]}],"source":["!ls"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RrEY9-I0Aaq_"},"outputs":[],"source":["movieDf = pd.read_csv('cleaneddf.csv')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":9,"status":"ok","timestamp":1686918457420,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"2eTLVQlL0IHc","outputId":"f35dc827-cbde-4377-a5b6-808157c08d83"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   Unnamed: 0  index   Genre  \\\n","0           0      7  comedy   \n","1           1     14  comedy   \n","2           2     15  comedy   \n","3           3     16   drama   \n","4           4     17   drama   \n","\n","                                                Plot  \n","0  <comedy>The film is about a family who move to...  \n","1  <comedy>Before heading out to a baseball game ...  \n","2  <comedy>The plot is that of a black woman goin...  \n","3  <drama>On a beautiful summer day a father and ...  \n","4  <drama>A thug accosts a girl as she leaves her...  "],"text/html":["\n","  <div id=\"df-907d725a-4804-4adf-aa44-ccd35835ba99\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>index</th>\n","      <th>Genre</th>\n","      <th>Plot</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>comedy</td>\n","      <td>&lt;comedy&gt;The film is about a family who move to...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>14</td>\n","      <td>comedy</td>\n","      <td>&lt;comedy&gt;Before heading out to a baseball game ...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>15</td>\n","      <td>comedy</td>\n","      <td>&lt;comedy&gt;The plot is that of a black woman goin...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>16</td>\n","      <td>drama</td>\n","      <td>&lt;drama&gt;On a beautiful summer day a father and ...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>17</td>\n","      <td>drama</td>\n","      <td>&lt;drama&gt;A thug accosts a girl as she leaves her...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-907d725a-4804-4adf-aa44-ccd35835ba99')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-907d725a-4804-4adf-aa44-ccd35835ba99 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-907d725a-4804-4adf-aa44-ccd35835ba99');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":8}],"source":["movieDf.head()"]},{"cell_type":"markdown","source":["Creating New df from our preprocessed df and including additional token BOS in plots"],"metadata":{"id":"EOobrVcWDWmO"}},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":120,"referenced_widgets":["61cc194f57944f23aebb4bb4ac2d7551","01ca41e6a68c43e4b35c90944f1d3741","fbaaff705e2140e8b0e5e58b283b0ad0","301381b0bf7e4cc1be6f58ca657df16a","ceb9612f86c54e428bd2a43ce70c6ce8"]},"executionInfo":{"elapsed":2083,"status":"ok","timestamp":1685309209955,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"mPPxPAdl4rHQ","outputId":"1e2b6c86-0531-4a1e-cfda-925be9512ada"},"outputs":[{"name":"stderr","output_type":"stream","text":["<ipython-input-9-8020d39e4531>:2: TqdmDeprecationWarning: This function will be removed in tqdm==5.0.0\n","Please use `tqdm.notebook.tqdm` instead of `tqdm.tqdm_notebook`\n","  with tqdm_notebook(total = len(movieDf)) as pbar:\n"]},{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"61cc194f57944f23aebb4bb4ac2d7551","version_major":2,"version_minor":0},"text/plain":["  0%|          | 0/13622 [00:00<?, ?it/s]"]},"metadata":{},"output_type":"display_data"}],"source":["outputs = []\n","with tqdm_notebook(total = len(movieDf)) as pbar:\n","  for ix, row in movieDf.iterrows():\n","\n","    genre_to_plot_input = f'<BOS> <{row.Genre}>'\n","    genre_to_plot_output = row.Plot\n","    outputs.append({\n","        \"source\": genre_to_plot_input,\n","        \"target\": genre_to_plot_output\n","    })\n","\n","    pbar.update(1)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GBuwvz-fRVtw"},"outputs":[],"source":["#save_pickle('new-t5-source-target-data.pkl', outputs)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":12047,"status":"ok","timestamp":1687101448100,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"w658TZ06AcXd","outputId":"2ab9949f-ecff-4d3f-8581-1e0d50cc5bee"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting sentencepiece\n","  Downloading sentencepiece-0.1.99-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m46.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: sentencepiece\n","Successfully installed sentencepiece-0.1.99\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: torch in /usr/local/lib/python3.10/dist-packages (2.0.1+cu118)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from torch) (3.12.0)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.10/dist-packages (from torch) (4.5.0)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch) (1.11.1)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch) (3.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch) (3.1.2)\n","Requirement already satisfied: triton==2.0.0 in /usr/local/lib/python3.10/dist-packages (from torch) (2.0.0)\n","Requirement already satisfied: cmake in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch) (3.25.2)\n","Requirement already satisfied: lit in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch) (16.0.5)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch) (2.1.2)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch) (1.3.0)\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: rich in /usr/local/lib/python3.10/dist-packages (13.3.4)\n","Requirement already satisfied: markdown-it-py<3.0.0,>=2.2.0 in /usr/local/lib/python3.10/dist-packages (from rich) (2.2.0)\n","Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.10/dist-packages (from rich) (2.14.0)\n","Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.10/dist-packages (from markdown-it-py<3.0.0,>=2.2.0->rich) (0.1.2)\n"]}],"source":["!pip install sentencepiece\n","!pip install torch\n","!pip install rich"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21562,"status":"ok","timestamp":1687101469651,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"zAD0mQJcSBC5","outputId":"29dd0c34-f3d6-4503-e21e-fb421d8a090e"},"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[33mWARNING: Skipping transformers as it is not installed.\u001b[0m\u001b[33m\n","\u001b[0m\u001b[33mWARNING: Skipping accelerate as it is not installed.\u001b[0m\u001b[33m\n","\u001b[0mLooking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers\n","  Downloading transformers-4.30.2-py3-none-any.whl (7.2 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.2/7.2 MB\u001b[0m \u001b[31m70.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting accelerate\n","  Downloading accelerate-0.20.3-py3-none-any.whl (227 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m227.6/227.6 kB\u001b[0m \u001b[31m22.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.12.0)\n","Collecting huggingface-hub<1.0,>=0.14.1 (from transformers)\n","  Downloading huggingface_hub-0.15.1-py3-none-any.whl (236 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m236.8/236.8 kB\u001b[0m \u001b[31m27.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (1.22.4)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (23.1)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (6.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2022.10.31)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers) (2.27.1)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1 (from transformers)\n","  Downloading tokenizers-0.13.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m40.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting safetensors>=0.3.1 (from transformers)\n","  Downloading safetensors-0.3.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m69.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers) (4.65.0)\n","Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate) (5.9.5)\n","Requirement already satisfied: torch>=1.6.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (2.0.1+cu118)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers) (2023.4.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers) (4.5.0)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (1.11.1)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1.2)\n","Requirement already satisfied: triton==2.0.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (2.0.0)\n","Requirement already satisfied: cmake in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (3.25.2)\n","Requirement already satisfied: lit in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (16.0.5)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2022.12.7)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2.0.12)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.4)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.6.0->accelerate) (2.1.2)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch>=1.6.0->accelerate) (1.3.0)\n","Installing collected packages: tokenizers, safetensors, huggingface-hub, transformers, accelerate\n","Successfully installed accelerate-0.20.3 huggingface-hub-0.15.1 safetensors-0.3.1 tokenizers-0.13.3 transformers-4.30.2\n"]}],"source":["!pip uninstall -y transformers accelerate\n","!pip install transformers accelerate"]},{"cell_type":"markdown","source":["Loading additional required libraires"],"metadata":{"id":"hfuRrDiTDjfT"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"c8yARDiQyzYy"},"outputs":[],"source":["import os\n","import re\n","import random\n","import pandas as pd\n","import numpy as np\n","import matplotlib.pyplot as plt\n","from tqdm import tqdm_notebook, tnrange\n","from sklearn.utils import shuffle\n","import pickle\n","import math\n","## use if working on jupyter notebook or colab\n","from IPython.display import clear_output"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"w8Xi6ZM1A7iC"},"outputs":[],"source":["import numpy as np\n","import torch\n","import torch.nn.functional as F\n","from torch.utils.data import Dataset, DataLoader\n","from rich.table import Column, Table\n","from rich import box\n","from rich.console import Console\n","from torch import cuda\n","device = 'cuda' if cuda.is_available() else 'cpu'"]},{"cell_type":"markdown","source":["Defining logging console to save training and validation stats"],"metadata":{"id":"WJtpQch2Dm6m"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"rX6YnOVLTYbu"},"outputs":[],"source":["console = Console(record=True)\n","training_logger = Table(\n","    Column(\"Random Selection\", justify = \"center\"),\n","    Column(\"Epoch\", justify=\"center\"),\n","    Column(\"Loss\", justify=\"center\"),\n","    title=\"Training Status\",\n","    pad_edge=False,\n","    box=box.ASCII,\n",")\n","valid_loggger = Table(\n","    Column(\"Random Selection\", justify = \"center\"),\n","    Column(\"Loss\", justify = \"center\"),\n","    title=\"Validation Status\",\n","    pad_edge=False,\n","    box=box.ASCII,\n",")"]},{"cell_type":"markdown","source":["Loading the above saved df"],"metadata":{"id":"HbaSAAA9DrNg"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"SV9PUHjzgNw5"},"outputs":[],"source":["data = load_pickle('new-t5-source-target-data.pkl')\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":365,"status":"ok","timestamp":1686918510200,"user":{"displayName":"saud hussain","userId":"14628660618575709689"},"user_tz":-120},"id":"8VnP8Ef1Ci3j","outputId":"302c18fd-5eec-44fd-a20a-00fb471209ac"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["13622"]},"metadata":{},"execution_count":15}],"source":["len(data)"]},{"cell_type":"markdown","source":["T5 Dataset Class to tokenizer the inputs"],"metadata":{"id":"_bLdadUSG88M"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"hCRbbS4BLP8D"},"outputs":[],"source":["class BartDataset(Dataset):\n","  def __init__(self, tokenizer, data, source_len, target_len):\n","    super(BartDataset, self).__init__()\n","    self.tokenizer = tokenizer\n","    self.source_len = source_len\n","    self.target_len = target_len\n","    self.data = data\n","  def __len__(self):\n","    return len(self.data)\n","  def __getitem__(self, index):\n","    source_seq = self.data[index]['source']\n","    target_seq = self.data[index]['target']\n","    source = self.tokenizer.batch_encode_plus(\n","        [source_seq],\n","        max_length = self.source_len,\n","        pad_to_max_length = True,\n","        truncation = True,\n","        padding = \"max_length\",\n","        return_tensors = \"pt\"\n","    )\n","    target = self.tokenizer.batch_encode_plus(\n","        [target_seq],\n","        max_length = self.target_len,\n","        pad_to_max_length = True,\n","        truncation = True,\n","        padding = \"max_length\",\n","        return_tensors = \"pt\"\n","    )\n","    source_ids = source[\"input_ids\"].squeeze()\n","    source_mask = source[\"attention_mask\"].squeeze()\n","    target_ids = target[\"input_ids\"].squeeze()\n","    target_mask = target[\"attention_mask\"].squeeze()\n","    return {\n","        \"source_ids\": source_ids,\n","        \"source_mask\": source_mask,\n","        \"target_ids\": target_ids,\n","        \"target_mask\": target_mask\n","    }"]},{"cell_type":"markdown","source":["Train function"],"metadata":{"id":"fu6fuVC6HAa_"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"fAyaDAILLfkf"},"outputs":[],"source":["def train(epoch, tokenizer, model, device, loader, optimizer):\n","\n","    model.train()\n","\n","    total_loss = 0\n","    total_counts = 0\n","\n","    for _, data in enumerate(tqdm_notebook(loader, desc = \"Train DL\")):\n","\n","        y = data[\"target_ids\"].to(device, dtype = torch.long)\n","        y_ids = y[:, :-1].contiguous()\n","        lm_labels = y[:, 1:].clone().detach()\n","        lm_labels[y[:, 1:] == tokenizer.pad_token_id] = -100\n","        ids = data[\"source_ids\"].to(device, dtype = torch.long)\n","        mask = data[\"source_mask\"].to(device, dtype = torch.long)\n","\n","\n","        optimizer.zero_grad()\n","\n","        outputs = model(\n","            input_ids = ids, attention_mask = mask, decoder_input_ids = y_ids, labels = lm_labels\n","        )\n","\n","        loss = outputs[0]\n","\n","        total_counts += 1\n","        total_loss += loss.item()\n","\n","\n","        loss.backward()\n","        optimizer.step()\n","\n","\n","    # training_logger.add_row(str(epoch), str(f'{total_loss/total_counts}'))\n","    # console.log(training_logger)\n","\n","    return total_loss/total_counts"]},{"cell_type":"markdown","source":["Validation Function"],"metadata":{"id":"DsT_4GR6HDOs"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"obw2zNCjiuum"},"outputs":[],"source":["def validate(epoch, tokenizer, model, device, loader):\n","    model.eval()\n","    total_loss = 0\n","    total_counts = 0\n","    with torch.no_grad():\n","        for _, data in enumerate(tqdm_notebook(loader, desc = \"Valid DL\")):\n","            y = data[\"target_ids\"].to(device, dtype = torch.long)\n","            y_ids = y[:, :-1].contiguous()\n","            lm_labels = y[:, 1:].clone().detach()\n","            lm_labels[y[:, 1:] == tokenizer.pad_token_id] = -100\n","            ids = data[\"source_ids\"].to(device, dtype = torch.long)\n","            mask = data[\"source_mask\"].to(device, dtype = torch.long)\n","            outputs = model(\n","            input_ids = ids, attention_mask = mask, decoder_input_ids = y_ids, labels = lm_labels\n","            )\n","            loss = outputs[0]\n","            total_loss += loss.item()\n","            total_counts += 1\n","    return total_loss / total_counts"]},{"cell_type":"markdown","source":["For Loading Model, Tokenizer and saving training and validation results"],"metadata":{"id":"cQ8vzDhyHE7Y"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"IgNhzKnq-N13"},"outputs":[],"source":["from transformers import BartTokenizer, BartModel,BartForConditionalGeneration\n","def trainer(\n","    data, model_params, output_dir = \"outputBartVersion1/\"\n","):\n","    torch.manual_seed(model_params[\"SEED\"])\n","    torch.cuda.manual_seed(model_params[\"SEED\"])\n","    np.random.seed(model_params[\"SEED\"])\n","    torch.backends.cudnn.deterministic = True\n","\n","    console.log(f'''Model: Loading {model_params['MODEL']}.....''')\n","    tokenizer = BartTokenizer.from_pretrained(model_params[\"MODEL\"])\n","    model = BartForConditionalGeneration.from_pretrained(model_params[\"MODEL\"])\n","    model = model.to(device)\n","    console.log(f\"[DATA]: READING DATA.......\")\n","    optimizer = torch.optim.Adam(\n","        params=model.parameters(), lr=model_params[\"LEARNING_RATE\"]\n","    )\n","    # Training loop\n","    console.log(f\"[Initiating Fine Tuning]...\\\\n\")\n","    ## model save path\n","    path = os.path.join(output_dir, \"model_files\")\n","\n","    copyData = data.copy()\n","    copyData = shuffle(copyData)\n","\n","    train_size = 0.75\n","    random_permuts = np.random.permutation(len(copyData))\n","    train_nums = round(len(random_permuts) * train_size)\n","    train_dataset = [copyData[i] for i in random_permuts[:train_nums]]\n","    valid_dataset = [copyData[i] for i in random_permuts[train_nums:]]\n","    training_set = BartDataset(\n","        tokenizer, train_dataset, model_params[\"MAX_SOURCE_TEXT_LENGTH\"], model_params[\"MAX_TARGET_TEXT_LENGTH\"]\n","    )\n","    val_set = BartDataset(\n","        tokenizer, valid_dataset, model_params[\"MAX_SOURCE_TEXT_LENGTH\"], model_params[\"MAX_TARGET_TEXT_LENGTH\"]\n","    )\n","    train_params = {\n","        \"batch_size\": model_params[\"TRAIN_BATCH_SIZE\"],\n","        \"shuffle\": True,\n","        \"num_workers\": 0\n","    }\n","    val_params = {\n","        \"batch_size\": model_params[\"VALID_BATCH_SIZE\"],\n","        \"shuffle\": False,\n","        \"num_workers\": 0\n","    }\n","    prev_loss=[]\n","    train_dl = DataLoader(training_set, **train_params)\n","\n","    ## training\n","    console.log(f'[MODEL TRAINING]')\n","    clear_output(wait=True)\n","    for epoch in tnrange(model_params[\"TRAIN_EPOCHS\"], desc=\"Training\"):\n","        total_loss = train(epoch, tokenizer, model, device, train_dl, optimizer)\n","        training_logger.add_row(str(epoch), str(total_loss))\n","        console.log(training_logger)\n","        if epoch == 0:\n","            console.log(f\"Saving Model at epoch: {epoch} with total loss: {total_loss}\")\n","            model.save_pretrained(os.path.join(output_dir, \"model_files_initial\"))\n","            tokenizer.save_pretrained(os.path.join(output_dir, \"model_files_initial\"))\n","        if epoch > 0:\n","            #if min(prev_loss) > total_loss:\n","            console.log(f\"Saving Model at epoch: {epoch} with total loss: {total_loss}\")\n","            model.save_pretrained(path)\n","            tokenizer.save_pretrained(path)"]},{"cell_type":"markdown","source":["Model Training Parameters"],"metadata":{"id":"f78L7jI2HH5O"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"LjSg9IyMObXj"},"outputs":[],"source":["model_params = {\n","    \"MODEL\": \"facebook/bart-base\", # if you have a bigger machine you can use t5-large\n","    \"TRAIN_BATCH_SIZE\": 2,\n","    \"VALID_BATCH_SIZE\": 2,\n","    \"TRAIN_EPOCHS\": 2,\n","    \"VAL_EPOCHS\": 2,\n","    \"LEARNING_RATE\": 1e-4,\n","    \"MAX_SOURCE_TEXT_LENGTH\": 128,\n","    \"MAX_TARGET_TEXT_LENGTH\": 786,\n","    \"SEED\": 3007,\n","    \"RANDOM_TRAIN_STEPS\": 0\n","}"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mSwX9HfaWDdI","colab":{"base_uri":"https://localhost:8080/","height":83},"executionInfo":{"status":"error","timestamp":1686918972919,"user_tz":-120,"elapsed":5,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"6ca3adb1-4084-4e08-87b5-3a16a3a38f96"},"outputs":[{"output_type":"display_data","data":{"text/plain":["\u001b[31m╭─\u001b[0m\u001b[31m──────────────────────────────\u001b[0m\u001b[31m \u001b[0m\u001b[1;31mTraceback \u001b[0m\u001b[1;2;31m(most recent call last)\u001b[0m\u001b[31m \u001b[0m\u001b[31m───────────────────────────────\u001b[0m\u001b[31m─╮\u001b[0m\n","\u001b[31m│\u001b[0m in \u001b[92m<cell line: 2>\u001b[0m:\u001b[94m2\u001b[0m                                                                              \u001b[31m│\u001b[0m\n","\u001b[31m╰──────────────────────────────────────────────────────────────────────────────────────────────────╯\u001b[0m\n","\u001b[1;91mFileExistsError: \u001b[0m\u001b[1m[\u001b[0mErrno \u001b[1;36m17\u001b[0m\u001b[1m]\u001b[0m File exists: \u001b[32m'outputBartVersion1'\u001b[0m\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #800000; text-decoration-color: #800000\">╭─────────────────────────────── </span><span style=\"color: #800000; text-decoration-color: #800000; font-weight: bold\">Traceback </span><span style=\"color: #bf7f7f; text-decoration-color: #bf7f7f; font-weight: bold\">(most recent call last)</span><span style=\"color: #800000; text-decoration-color: #800000\"> ────────────────────────────────╮</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">│</span> in <span style=\"color: #00ff00; text-decoration-color: #00ff00\">&lt;cell line: 2&gt;</span>:<span style=\"color: #0000ff; text-decoration-color: #0000ff\">2</span>                                                                              <span style=\"color: #800000; text-decoration-color: #800000\">│</span>\n","<span style=\"color: #800000; text-decoration-color: #800000\">╰──────────────────────────────────────────────────────────────────────────────────────────────────╯</span>\n","<span style=\"color: #ff0000; text-decoration-color: #ff0000; font-weight: bold\">FileExistsError: </span><span style=\"font-weight: bold\">[</span>Errno <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">17</span><span style=\"font-weight: bold\">]</span> File exists: <span style=\"color: #008000; text-decoration-color: #008000\">'outputBartVersion1'</span>\n","</pre>\n"]},"metadata":{}}],"source":["#import os\n","#os.mkdir(\"outputBartVersion1\")"]},{"cell_type":"markdown","source":["Trainer object"],"metadata":{"id":"3CWGEy3DHQ8I"}},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":470,"referenced_widgets":["f0eab799856c4e06905a4b0f2817ccb7","15a255ba607649f0a2b433db1b3b2a4b","4f395d63c6ae4fbfa8ce68617814ebcf","97ac45a591444670ac5f1474749d27b0","c0e699a82b644bca81d62590c2b30cea","f3345025e3ea45e490b4425badd230d1","adf24f4d87f2456e9ef21cae18a7006b","aa045be31078487f8130c23582f2cd39","cf6bacb3ca9240279d6ebe33c51f0e52","f6fec6b82528490687236b70ddf35156","1a74f6be9adf405089ebc1a3406f1586","70cbe7eb755946baa4a4dddc4f0f981a","a9d47b7c058649e9afdc97f374a1bd07","ef19a1fb5f5f4f979c6887e1e6eb3cd3","132d5f1594704af18bc7a43779996809","341db4ae56a847478a7c0b04fbd80a5d","56555c5e87f541fd9410645e2ae96e9d","8239532a50664a238795c9b839b99d6c","8889b5936ef740bf8eaff3cade4be147","65492ecbce294e0b8f264311a91580c4","5668dfb0524045b2afddd363e77eca1e","ccccfc2a45eb4f76808220d8b9b3cdae","89520944e6564fe2b975027815be8282","7d923a68657c499296ea871016e4547d","9cbc66ca21bb4e3bae439a00f9ee1f58","86332fcc25554107b8c0f9a813abd10d","d12490b40de44eeea79765b2fdc38f31","ad9449b3dfe94ceab73196faaa897fec","481ca77d4ce245398b2989d42541851f","a00bb2b1b5ce484cb77ef5f201e01635","78bcf31e240e496fb050ed9dd949707d","e2e64dfcbe474ff8892b4a6403939a50","af7f33563795497f83c9b34f2d1d0099","ef556f58cc2a4640aa773e09707d3e11","cb814eba896b41cb80131f361aaad425","bd722a8bb19c4c39a9dfa95d1b141254","7e9a0ab4d64a43019118e7de1359c314","bdcabc016dbe4883800b394fc11eac96","f351a44e8a4844c58cb1117c0df8d568","f7bf08d79a9949bbbddff1a6fbda6743","e32302f6a215484aa00bbb23b42e6e66","5cb9c153911b4c529fc1e438d3228ad8","f1f3adcd68ca4009bba2b5278eef8b9b","b45145051b3d4b87a6d442e3d3266913"]},"id":"8HACaNkQjRmF","executionInfo":{"status":"ok","timestamp":1686922703491,"user_tz":-120,"elapsed":3710166,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"5db93066-b1c8-4a48-ae8b-ca556e8df1dd"},"outputs":[{"output_type":"stream","name":"stderr","text":["<ipython-input-28-32f6d92fe2ce>:53: TqdmDeprecationWarning: Please use `tqdm.notebook.trange` instead of `tqdm.tnrange`\n","  for epoch in tnrange(model_params[\"TRAIN_EPOCHS\"], desc=\"Training\"):\n"]},{"output_type":"display_data","data":{"text/plain":["Training:   0%|          | 0/2 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"70cbe7eb755946baa4a4dddc4f0f981a"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["<ipython-input-17-624dfd2a5a30>:8: TqdmDeprecationWarning: This function will be removed in tqdm==5.0.0\n","Please use `tqdm.notebook.tqdm` instead of `tqdm.tqdm_notebook`\n","  for _, data in enumerate(tqdm_notebook(loader, desc = \"Train DL\")):\n"]},{"output_type":"display_data","data":{"text/plain":["Train DL:   0%|          | 0/5108 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"89520944e6564fe2b975027815be8282"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[2;36m[13:07:31]\u001b[0m\u001b[2;36m \u001b[0m\u001b[3m               Training Status               \u001b[0m                         \u001b[2m<ipython-input-28-32f6d92fe2ce>\u001b[0m\u001b[2m:\u001b[0m\u001b[2m56\u001b[0m\n","\u001b[2;36m           \u001b[0m+-------------------------------------------+                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|\u001b[1mRandom Selection\u001b[0m\u001b[1m \u001b[0m|\u001b[1m \u001b[0m\u001b[1m      Epoch      \u001b[0m\u001b[1m \u001b[0m|\u001b[1m \u001b[0m\u001b[1mLoss\u001b[0m|                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|-----------------+-------------------+-----|                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|       0         | 3.897141858760323 |     |                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m+-------------------------------------------+                         \u001b[2m                                  \u001b[0m\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">[13:07:31] </span><span style=\"font-style: italic\">               Training Status               </span>                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">&lt;ipython-input-28-32f6d92fe2ce&gt;:56</span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>+-------------------------------------------+                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|<span style=\"font-weight: bold\">Random Selection </span>|<span style=\"font-weight: bold\">       Epoch       </span>|<span style=\"font-weight: bold\"> Loss</span>|                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|-----------------+-------------------+-----|                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|       0         | 3.897141858760323 |     |                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>+-------------------------------------------+                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[2;36m          \u001b[0m\u001b[2;36m \u001b[0mSaving Model at epoch: \u001b[1;36m0\u001b[0m with total loss: \u001b[1;36m3.897141858760323\u001b[0m           \u001b[2m<ipython-input-28-32f6d92fe2ce>\u001b[0m\u001b[2m:\u001b[0m\u001b[2m58\u001b[0m\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>Saving Model at epoch: <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span> with total loss: <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.897141858760323</span>           <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">&lt;ipython-input-28-32f6d92fe2ce&gt;:58</span>\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Train DL:   0%|          | 0/5108 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"ef556f58cc2a4640aa773e09707d3e11"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[2;36m[13:38:20]\u001b[0m\u001b[2;36m \u001b[0m\u001b[3m               Training Status               \u001b[0m                         \u001b[2m<ipython-input-28-32f6d92fe2ce>\u001b[0m\u001b[2m:\u001b[0m\u001b[2m56\u001b[0m\n","\u001b[2;36m           \u001b[0m+-------------------------------------------+                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|\u001b[1mRandom Selection\u001b[0m\u001b[1m \u001b[0m|\u001b[1m \u001b[0m\u001b[1m      Epoch      \u001b[0m\u001b[1m \u001b[0m|\u001b[1m \u001b[0m\u001b[1mLoss\u001b[0m|                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|-----------------+-------------------+-----|                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|       0         | 3.897141858760323 |     |                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m|       1         |  3.570137824271   |     |                         \u001b[2m                                  \u001b[0m\n","\u001b[2;36m           \u001b[0m+-------------------------------------------+                         \u001b[2m                                  \u001b[0m\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">[13:38:20] </span><span style=\"font-style: italic\">               Training Status               </span>                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">&lt;ipython-input-28-32f6d92fe2ce&gt;:56</span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>+-------------------------------------------+                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|<span style=\"font-weight: bold\">Random Selection </span>|<span style=\"font-weight: bold\">       Epoch       </span>|<span style=\"font-weight: bold\"> Loss</span>|                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|-----------------+-------------------+-----|                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|       0         | 3.897141858760323 |     |                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>|       1         |  3.570137824271   |     |                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>+-------------------------------------------+                         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">                                  </span>\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[2;36m          \u001b[0m\u001b[2;36m \u001b[0mSaving Model at epoch: \u001b[1;36m1\u001b[0m with total loss: \u001b[1;36m3.570137824271\u001b[0m              \u001b[2m<ipython-input-28-32f6d92fe2ce>\u001b[0m\u001b[2m:\u001b[0m\u001b[2m63\u001b[0m\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span>Saving Model at epoch: <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span> with total loss: <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.570137824271</span>              <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">&lt;ipython-input-28-32f6d92fe2ce&gt;:63</span>\n","</pre>\n"]},"metadata":{}}],"source":["trainer(\n","    data = data,\n","    model_params = model_params,\n","    output_dir = \"outputBartVersion1\"\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pEkDIdX0yEu5"},"outputs":[],"source":["import os\n","import re\n","import random\n","import pandas as pd\n","import numpy as np\n","import matplotlib.pyplot as plt\n","from tqdm import tqdm_notebook, tnrange\n","from sklearn.utils import shuffle\n","import pickle\n","import math\n","import torch\n","import torch.nn.functional as F\n","from transformers import BartForConditionalGeneration, BartTokenizer"]},{"cell_type":"markdown","source":["Loading Saved Model and Tokenizer"],"metadata":{"id":"PyyZ2iQ2HTJy"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"W4Q92WWCO80J"},"outputs":[],"source":["torch.manual_seed(3007)\n","model = BartForConditionalGeneration.from_pretrained('outputBartVersion1/model_files')\n","tokenizer = BartTokenizer.from_pretrained('outputBartVersion1/model_files')"]},{"cell_type":"markdown","source":["Function to generate plots"],"metadata":{"id":"mCqvvEzyHVWZ"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"FY-yzCctWLMF"},"outputs":[],"source":["def generate_n_text_samples(model, tokenizer, input_text, device, n_samples):\n","    text_ids = tokenizer.encode(input_text, return_tensors = 'pt')\n","    text_ids = text_ids.to(device)\n","    model = model.to(device)\n","\n","    generated_text_samples = model.generate(\n","        text_ids,\n","        max_length= 100,\n","        num_return_sequences= n_samples,\n","        num_beams=n_samples+1,\n","        no_repeat_ngram_size= 2,\n","        repetition_penalty= 1.5,\n","        top_p= 0.92,\n","        temperature= .85,\n","        do_sample= True,\n","        top_k= 125,\n","        early_stopping= True\n","    )\n","    gen_text = []\n","    for t in generated_text_samples:\n","        text = tokenizer.decode(t, skip_special_tokens=True)\n","        gen_text.append(text)\n","        print(gen_text)\n","\n","        return gen_text\n"]},{"cell_type":"markdown","source":["function to calculate self-bleu score"],"metadata":{"id":"Tso1zP2bHXvI"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"Dgpaj8cw_CNb"},"outputs":[],"source":["import nltk\n","from nltk.translate.bleu_score import sentence_bleu\n","\n","def calculate_self_bleu(stories):\n","    self_bleu_scores = []\n","\n","    for story in stories:\n","        segments = story.split(\".\")  # Split the story into segments (e.g., by newline)\n","        #print(segments)\n","        bleu_scores = []\n","\n","        for i in range(len(segments)):\n","            reference = segments[:i] + segments[i+1:]  # Remove the current segment as reference\n","\n","            hypothesis = segments[i]\n","\n","            bleu_scores.append(sentence_bleu(reference, hypothesis))\n","\n","        self_bleu_scores.append(sum(bleu_scores) / len(bleu_scores))\n","\n","    average_self_bleu = sum(self_bleu_scores) / len(self_bleu_scores)\n","    return average_self_bleu\n","\n"]},{"cell_type":"markdown","source":["Results 1 and Its Score"],"metadata":{"id":"SPB2X8qeHruK"}},{"cell_type":"code","source":["input_prompt = \"<BOS><superhero> Batman\"\n","#input_text = tokenizer.bos_token\n","device = \"cuda:0\"\n","\n","headlines = generate_n_text_samples(model, tokenizer,\n","                                    input_prompt, device,n_samples = 1)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"QRBrB9MzXIVV","executionInfo":{"status":"ok","timestamp":1687102509823,"user_tz":-120,"elapsed":1997,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"8abd23aa-e76c-4193-9e7c-09d1dab7536a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[\"superhero>The film opens with a group of young people, including the girlfriend of one of the boys, who has just returned from Europe. They are looking for a job, but find themselves in the middle of nowhere. The next day, they are attacked by a gang of thugs led by Johnny (Kiefer Sutherland), who is planning to rob them.\\r\\nThe next morning, the gang and Johnny have a confrontation with Johnny's gang. Johnny kidnaps Johnny and takes\"]\n"]}]},{"cell_type":"code","source":["# Example usage\n","generated_stories = headlines\n","#print(headlines)\n","self_bleu_score = calculate_self_bleu(generated_stories)\n","print(\"Self-BLEU score:\", self_bleu_score)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"s4qeOqUBEiEE","executionInfo":{"status":"ok","timestamp":1687102529369,"user_tz":-120,"elapsed":231,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"a50e06ca-d887-4dfc-aaf6-42bf3b48cb6b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Self-BLEU score: 0.4006932443764093\n"]}]},{"cell_type":"markdown","source":["Results 2 and Its Score"],"metadata":{"id":"RIH4S3ZXHv3R"}},{"cell_type":"code","source":["input_prompt = \"<BOS> <comedy>\"\n","#input_text = tokenizer.bos_token\n","device = \"cuda:0\"\n","\n","headlines = generate_n_text_samples(model, tokenizer,\n","                                    input_prompt, device,n_samples = 1)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9owf2UGgXIRD","executionInfo":{"status":"ok","timestamp":1687102537101,"user_tz":-120,"elapsed":999,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"09c886a1-6e90-4384-ecb1-f6a536cf42aa"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["['comedy>In a small town in Georgia, two friends (Hugh Grant) are invited to a party hosted by a local girl. The party is a success, but the party turns out to be a huge success.']\n"]}]},{"cell_type":"code","source":["# Example usage\n","generated_stories = headlines\n","#print(headlines)\n","self_bleu_score = calculate_self_bleu(generated_stories)\n","print(\"Self-BLEU score:\", self_bleu_score)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"CAX7ahS9EoQM","executionInfo":{"status":"ok","timestamp":1687102551434,"user_tz":-120,"elapsed":271,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"d09197be-1195-451d-a46b-5aab117ee386"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Self-BLEU score: 0.10330192705439423\n"]}]},{"cell_type":"markdown","source":["Results 3 and its score"],"metadata":{"id":"07zbUJouHxf8"}},{"cell_type":"code","source":["input_prompt = \"<BOS><action>\"\n","#input_text = tokenizer.bos_token\n","device = \"cuda:0\"\n","\n","headlines = generate_n_text_samples(model, tokenizer,\n","                                    input_prompt, device,n_samples = 1)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Hvqe7a3zXIN-","executionInfo":{"status":"ok","timestamp":1687102556579,"user_tz":-120,"elapsed":1955,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"5b7c87b7-bb1a-412d-827e-2a136791f55e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["['action>The film opens with a group of college students and their friends in a school bus. They are going to spend some time together at a local resort. The kids are supposed to go to a club, but they end up having a gang fight with the boys.\\r\\nThe next day, they find out that their parents have been killed by a drug dealer named \"Bobby\" (Vincent Price), who is trying to rob them. Meanwhile, Bobby is getting evicted']\n"]}]},{"cell_type":"code","source":["# Example usage\n","generated_stories = headlines\n","#print(headlines)\n","self_bleu_score = calculate_self_bleu(generated_stories)\n","print(\"Self-BLEU score:\", self_bleu_score)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2TAaPMa6EpBZ","executionInfo":{"status":"ok","timestamp":1687102558299,"user_tz":-120,"elapsed":235,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"5868d2e4-357a-4eac-fb1d-afa56901fea8"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Self-BLEU score: 0.38487346971192476\n"]}]},{"cell_type":"markdown","source":["Results 4 and Its score"],"metadata":{"id":"FFnu-neDH0AG"}},{"cell_type":"code","source":["input_prompt = \"<BOS><horror>\"\n","#input_text = tokenizer.bos_token\n","device = \"cuda:0\"\n","\n","headlines = generate_n_text_samples(model, tokenizer,\n","                                    input_prompt, device,n_samples = 1)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2ezSlFERdVY1","executionInfo":{"status":"ok","timestamp":1687102575285,"user_tz":-120,"elapsed":1436,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"0859a039-33b5-45c3-e5f6-8d3462b31259"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["['horror>The film opens with a group of college students in a forest near the village of Kondana. The students are preparing for their next class, but they are attacked by a mysterious force. They manage to escape, only to find themselves trapped inside a cave.\\r\\nThe next morning, they meet an old man who claims to be a witch, and is trying to kill them. He asks for help from a friend, who explains that he was a humaniser,']\n"]}]},{"cell_type":"code","source":["# Example usage\n","generated_stories = headlines\n","#print(headlines)\n","self_bleu_score = calculate_self_bleu(generated_stories)\n","print(\"Self-BLEU score:\", self_bleu_score)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"w_xFEw0NEpmT","executionInfo":{"status":"ok","timestamp":1687102576609,"user_tz":-120,"elapsed":245,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"fac367a8-d6b8-468e-8fa4-390028088c8f"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Self-BLEU score: 0.4445652125889595\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZtyfoYf6vbW6"},"outputs":[],"source":[]}],"metadata":{"accelerator":"GPU","colab":{"provenance":[{"file_id":"1lcEutxz7ILXAaURNWJ893gGPQZPZvOiS","timestamp":1686918325217},{"file_id":"1v61u9V2CPmWmOffYWnIWuPkxvNk7XttK","timestamp":1684368241793}],"authorship_tag":"ABX9TyOvz4zPdvw9hXIJd9qduB0i"},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"61cc194f57944f23aebb4bb4ac2d7551":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_01ca41e6a68c43e4b35c90944f1d3741","IPY_MODEL_fbaaff705e2140e8b0e5e58b283b0ad0","IPY_MODEL_301381b0bf7e4cc1be6f58ca657df16a"],"layout":"IPY_MODEL_ceb9612f86c54e428bd2a43ce70c6ce8"}},"f0eab799856c4e06905a4b0f2817ccb7":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_15a255ba607649f0a2b433db1b3b2a4b","IPY_MODEL_4f395d63c6ae4fbfa8ce68617814ebcf","IPY_MODEL_97ac45a591444670ac5f1474749d27b0"],"layout":"IPY_MODEL_c0e699a82b644bca81d62590c2b30cea"}},"15a255ba607649f0a2b433db1b3b2a4b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f3345025e3ea45e490b4425badd230d1","placeholder":"​","style":"IPY_MODEL_adf24f4d87f2456e9ef21cae18a7006b","value":"Downloading model.safetensors: 100%"}},"4f395d63c6ae4fbfa8ce68617814ebcf":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_aa045be31078487f8130c23582f2cd39","max":557709915,"min":0,"orientation":"horizontal","style":"IPY_MODEL_cf6bacb3ca9240279d6ebe33c51f0e52","value":557709915}},"97ac45a591444670ac5f1474749d27b0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f6fec6b82528490687236b70ddf35156","placeholder":"​","style":"IPY_MODEL_1a74f6be9adf405089ebc1a3406f1586","value":" 558M/558M [00:05&lt;00:00, 232MB/s]"}},"c0e699a82b644bca81d62590c2b30cea":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f3345025e3ea45e490b4425badd230d1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"adf24f4d87f2456e9ef21cae18a7006b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"aa045be31078487f8130c23582f2cd39":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cf6bacb3ca9240279d6ebe33c51f0e52":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f6fec6b82528490687236b70ddf35156":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1a74f6be9adf405089ebc1a3406f1586":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"70cbe7eb755946baa4a4dddc4f0f981a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a9d47b7c058649e9afdc97f374a1bd07","IPY_MODEL_ef19a1fb5f5f4f979c6887e1e6eb3cd3","IPY_MODEL_132d5f1594704af18bc7a43779996809"],"layout":"IPY_MODEL_341db4ae56a847478a7c0b04fbd80a5d"}},"a9d47b7c058649e9afdc97f374a1bd07":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_56555c5e87f541fd9410645e2ae96e9d","placeholder":"​","style":"IPY_MODEL_8239532a50664a238795c9b839b99d6c","value":"Training: 100%"}},"ef19a1fb5f5f4f979c6887e1e6eb3cd3":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_8889b5936ef740bf8eaff3cade4be147","max":2,"min":0,"orientation":"horizontal","style":"IPY_MODEL_65492ecbce294e0b8f264311a91580c4","value":2}},"132d5f1594704af18bc7a43779996809":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5668dfb0524045b2afddd363e77eca1e","placeholder":"​","style":"IPY_MODEL_ccccfc2a45eb4f76808220d8b9b3cdae","value":" 2/2 [1:01:32&lt;00:00, 1846.03s/it]"}},"341db4ae56a847478a7c0b04fbd80a5d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"56555c5e87f541fd9410645e2ae96e9d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8239532a50664a238795c9b839b99d6c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8889b5936ef740bf8eaff3cade4be147":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"65492ecbce294e0b8f264311a91580c4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5668dfb0524045b2afddd363e77eca1e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ccccfc2a45eb4f76808220d8b9b3cdae":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"89520944e6564fe2b975027815be8282":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_7d923a68657c499296ea871016e4547d","IPY_MODEL_9cbc66ca21bb4e3bae439a00f9ee1f58","IPY_MODEL_86332fcc25554107b8c0f9a813abd10d"],"layout":"IPY_MODEL_d12490b40de44eeea79765b2fdc38f31"}},"7d923a68657c499296ea871016e4547d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ad9449b3dfe94ceab73196faaa897fec","placeholder":"​","style":"IPY_MODEL_481ca77d4ce245398b2989d42541851f","value":"Train DL: 100%"}},"9cbc66ca21bb4e3bae439a00f9ee1f58":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_a00bb2b1b5ce484cb77ef5f201e01635","max":5108,"min":0,"orientation":"horizontal","style":"IPY_MODEL_78bcf31e240e496fb050ed9dd949707d","value":5108}},"86332fcc25554107b8c0f9a813abd10d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e2e64dfcbe474ff8892b4a6403939a50","placeholder":"​","style":"IPY_MODEL_af7f33563795497f83c9b34f2d1d0099","value":" 5108/5108 [30:41&lt;00:00,  2.83it/s]"}},"d12490b40de44eeea79765b2fdc38f31":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ad9449b3dfe94ceab73196faaa897fec":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"481ca77d4ce245398b2989d42541851f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a00bb2b1b5ce484cb77ef5f201e01635":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"78bcf31e240e496fb050ed9dd949707d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"e2e64dfcbe474ff8892b4a6403939a50":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"af7f33563795497f83c9b34f2d1d0099":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ef556f58cc2a4640aa773e09707d3e11":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_cb814eba896b41cb80131f361aaad425","IPY_MODEL_bd722a8bb19c4c39a9dfa95d1b141254","IPY_MODEL_7e9a0ab4d64a43019118e7de1359c314"],"layout":"IPY_MODEL_bdcabc016dbe4883800b394fc11eac96"}},"cb814eba896b41cb80131f361aaad425":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f351a44e8a4844c58cb1117c0df8d568","placeholder":"​","style":"IPY_MODEL_f7bf08d79a9949bbbddff1a6fbda6743","value":"Train DL: 100%"}},"bd722a8bb19c4c39a9dfa95d1b141254":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_e32302f6a215484aa00bbb23b42e6e66","max":5108,"min":0,"orientation":"horizontal","style":"IPY_MODEL_5cb9c153911b4c529fc1e438d3228ad8","value":5108}},"7e9a0ab4d64a43019118e7de1359c314":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f1f3adcd68ca4009bba2b5278eef8b9b","placeholder":"​","style":"IPY_MODEL_b45145051b3d4b87a6d442e3d3266913","value":" 5108/5108 [30:42&lt;00:00,  2.77it/s]"}},"bdcabc016dbe4883800b394fc11eac96":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f351a44e8a4844c58cb1117c0df8d568":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f7bf08d79a9949bbbddff1a6fbda6743":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e32302f6a215484aa00bbb23b42e6e66":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5cb9c153911b4c529fc1e438d3228ad8":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f1f3adcd68ca4009bba2b5278eef8b9b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b45145051b3d4b87a6d442e3d3266913":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat":4,"nbformat_minor":0}