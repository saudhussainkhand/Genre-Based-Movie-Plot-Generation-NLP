{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[{"file_id":"1lcEutxz7ILXAaURNWJ893gGPQZPZvOiS","timestamp":1684415727237},{"file_id":"1v61u9V2CPmWmOffYWnIWuPkxvNk7XttK","timestamp":1684368241793}],"gpuType":"T4","authorship_tag":"ABX9TyMfCqWCregNmqAXHbtDjWHv"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"11e92175f2d143c6b19eed78950c58d2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_8b3e381caef6437e862b1874b740b2d5","IPY_MODEL_18506f48d8404ebb81151b9826a6d141","IPY_MODEL_876801782aef42f59c941adf82b08da3"],"layout":"IPY_MODEL_a319fb6ec3ed449a824adcfde82c58a2"}},"8b3e381caef6437e862b1874b740b2d5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_690dfedb819e44f2bc96f6fd82ed11ff","placeholder":"​","style":"IPY_MODEL_9a2879717804461cb2564c7a93b279f1","value":"Downloading pytorch_model.bin: 100%"}},"18506f48d8404ebb81151b9826a6d141":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_60a9b952b9834be7b79549f4fda3e5dd","max":526017373,"min":0,"orientation":"horizontal","style":"IPY_MODEL_6bf8dbac6e0c417f8d37e9379b6448d2","value":526017373}},"876801782aef42f59c941adf82b08da3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_54960193cbb24d1ba1d4496384931023","placeholder":"​","style":"IPY_MODEL_3ca7e026c858491096e471ddc48cd745","value":" 526M/526M [00:01&lt;00:00, 342MB/s]"}},"a319fb6ec3ed449a824adcfde82c58a2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"690dfedb819e44f2bc96f6fd82ed11ff":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9a2879717804461cb2564c7a93b279f1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"60a9b952b9834be7b79549f4fda3e5dd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6bf8dbac6e0c417f8d37e9379b6448d2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"54960193cbb24d1ba1d4496384931023":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3ca7e026c858491096e471ddc48cd745":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1e579465835a4da580c8e5242a6de55f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_514521ee680845b682f728686a0762a7","IPY_MODEL_71ca771fff7940faba3aa515899cfabf","IPY_MODEL_7554bf47f6484631b364e70e8f8ee59c"],"layout":"IPY_MODEL_0589e1c9641940b9bad27dd8662601b5"}},"514521ee680845b682f728686a0762a7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e39d8e4104b04633955b13644e1f4f18","placeholder":"​","style":"IPY_MODEL_5120569113f2464bb86c8dcf6e5740cd","value":"Map (num_proc=5):  96%"}},"71ca771fff7940faba3aa515899cfabf":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_481ec9d786b846c2b407c3df88e5b519","max":6129,"min":0,"orientation":"horizontal","style":"IPY_MODEL_d8673504c6bc4bcaa81d5e92739c63a8","value":6129}},"7554bf47f6484631b364e70e8f8ee59c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ae26ceb92cd647c4b09364e98147dcb4","placeholder":"​","style":"IPY_MODEL_75ca1c84371b4a5e91802b02af2781ce","value":" 5903/6129 [00:09&lt;00:00, 915.58 examples/s]"}},"0589e1c9641940b9bad27dd8662601b5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"e39d8e4104b04633955b13644e1f4f18":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5120569113f2464bb86c8dcf6e5740cd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"481ec9d786b846c2b407c3df88e5b519":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d8673504c6bc4bcaa81d5e92739c63a8":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ae26ceb92cd647c4b09364e98147dcb4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"75ca1c84371b4a5e91802b02af2781ce":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"98ebbc1b976144cea657804eea449db4":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_7ad324a9c1934d6db777c36b03c79b09","IPY_MODEL_69a73a3177b34983a59f89e3cfc08079","IPY_MODEL_299b47aa16624b7aac6578c95d2b65c8"],"layout":"IPY_MODEL_58ffde52ab4d43f4b7cc04a8caec7e15"}},"7ad324a9c1934d6db777c36b03c79b09":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d7db2b21f93842bb91f0f58c5a58d89c","placeholder":"​","style":"IPY_MODEL_0ec544ef40ea4cc5bd3eb8f5c3ec004a","value":"Map (num_proc=5): 100%"}},"69a73a3177b34983a59f89e3cfc08079":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_8458c293946d45d59353ae9fbcc9f164","max":682,"min":0,"orientation":"horizontal","style":"IPY_MODEL_fd4c92f3b49749899e1219f631715ac5","value":682}},"299b47aa16624b7aac6578c95d2b65c8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_34edc5319d214b8d9e860f0d510b9fa2","placeholder":"​","style":"IPY_MODEL_d87f3ed737ac4e7694d0cb361ad3b202","value":" 682/682 [00:01&lt;00:00, 841.54 examples/s]"}},"58ffde52ab4d43f4b7cc04a8caec7e15":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"d7db2b21f93842bb91f0f58c5a58d89c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0ec544ef40ea4cc5bd3eb8f5c3ec004a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8458c293946d45d59353ae9fbcc9f164":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fd4c92f3b49749899e1219f631715ac5":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"34edc5319d214b8d9e860f0d510b9fa2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d87f3ed737ac4e7694d0cb361ad3b202":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"64238718ff864ba1a57cece073f35572":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_cfc206c5ae0d4c8db829fb0cf570e310","IPY_MODEL_27b09f3f36014e658da4b9243a07c6c3","IPY_MODEL_733a16946e2949c3b97572735d0c8637"],"layout":"IPY_MODEL_99bf6f6c32934ed49c7af2924421cea0"}},"cfc206c5ae0d4c8db829fb0cf570e310":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_cb3e2c68c4fd43a9ba1ad8bdbb6478a7","placeholder":"​","style":"IPY_MODEL_5d6d4b8cb5274161853e273408567023","value":"Downloading (…)okenizer_config.json: 100%"}},"27b09f3f36014e658da4b9243a07c6c3":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_903b4900f170450ca274bee5e2de47f9","max":560,"min":0,"orientation":"horizontal","style":"IPY_MODEL_1b6f13eabafd45148e169bc6dfeae4f5","value":560}},"733a16946e2949c3b97572735d0c8637":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4a4a4ae084df4b7db0c42c0729185c4e","placeholder":"​","style":"IPY_MODEL_3e50d98218324ea2afe68ac91e1400b1","value":" 560/560 [00:00&lt;00:00, 8.95kB/s]"}},"99bf6f6c32934ed49c7af2924421cea0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cb3e2c68c4fd43a9ba1ad8bdbb6478a7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5d6d4b8cb5274161853e273408567023":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"903b4900f170450ca274bee5e2de47f9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1b6f13eabafd45148e169bc6dfeae4f5":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"4a4a4ae084df4b7db0c42c0729185c4e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3e50d98218324ea2afe68ac91e1400b1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b6b8681d13fa4c679fa4fe802ba80f61":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e0d66106346b4c1f9cd606603ef38604","IPY_MODEL_012499e39caa4e17ae91f12e16dc5f7a","IPY_MODEL_37dc0ca4d8d0464cbf2f839b27533b3d"],"layout":"IPY_MODEL_dba0be2b1b0848d1b2ac2826161bd360"}},"e0d66106346b4c1f9cd606603ef38604":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5f2a75ccb4774a1293234425f0e139a4","placeholder":"​","style":"IPY_MODEL_43dfab340dda42e288f55085686411e0","value":"Downloading (…)lve/main/config.json: 100%"}},"012499e39caa4e17ae91f12e16dc5f7a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6e597c9f552b4519995f1a288d1c83d5","max":1007,"min":0,"orientation":"horizontal","style":"IPY_MODEL_26930e3d5d564cad8721c027944b4ad4","value":1007}},"37dc0ca4d8d0464cbf2f839b27533b3d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a1d575dd364748789984a9738aa63549","placeholder":"​","style":"IPY_MODEL_00081927c8714c00b11645a88b4d554f","value":" 1.01k/1.01k [00:00&lt;00:00, 16.9kB/s]"}},"dba0be2b1b0848d1b2ac2826161bd360":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5f2a75ccb4774a1293234425f0e139a4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"43dfab340dda42e288f55085686411e0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6e597c9f552b4519995f1a288d1c83d5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"26930e3d5d564cad8721c027944b4ad4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a1d575dd364748789984a9738aa63549":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"00081927c8714c00b11645a88b4d554f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"14c29614ecb643e8b9de3e0f9d56293d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_eac7b263c3924b919e231905fff1fd57","IPY_MODEL_8ce63cef4f1b4e5ab6d1bb6727a58fd2","IPY_MODEL_c2f19983884f4c2b8d8c66657e8f0460"],"layout":"IPY_MODEL_62c4d318dc14459bb3f9b77b9b945029"}},"eac7b263c3924b919e231905fff1fd57":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d2a2c407cf3e4cf6adf0d04bbc9e175e","placeholder":"​","style":"IPY_MODEL_3126fdeddb144b9aa7169600fb54a030","value":"Downloading (…)olve/main/vocab.json: 100%"}},"8ce63cef4f1b4e5ab6d1bb6727a58fd2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_2758fecdb260488ebf6472183d88df22","max":898669,"min":0,"orientation":"horizontal","style":"IPY_MODEL_defeb12343aa455d8600aea32d599f86","value":898669}},"c2f19983884f4c2b8d8c66657e8f0460":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ba5823ed41ee490ca041051a3497006a","placeholder":"​","style":"IPY_MODEL_b37967068b474b5aa89e135fa4394fc9","value":" 899k/899k [00:00&lt;00:00, 1.42MB/s]"}},"62c4d318dc14459bb3f9b77b9b945029":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d2a2c407cf3e4cf6adf0d04bbc9e175e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3126fdeddb144b9aa7169600fb54a030":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2758fecdb260488ebf6472183d88df22":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"defeb12343aa455d8600aea32d599f86":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ba5823ed41ee490ca041051a3497006a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b37967068b474b5aa89e135fa4394fc9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e04cf1b57a7d40039664e55c96359731":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_16b00df67ca942c48458fc871de2cbdd","IPY_MODEL_987f1ae36a1e4ed780b6f3eb06c306a9","IPY_MODEL_3cd267c247f943daa086417456b3ba73"],"layout":"IPY_MODEL_4ac4623662934546a6989c0e98b7a3b0"}},"16b00df67ca942c48458fc871de2cbdd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_215405f937a94a07ab2ef8d04fae8e42","placeholder":"​","style":"IPY_MODEL_37d6c70a595e4782b540bc8bbb3f2a5c","value":"Downloading (…)olve/main/merges.txt: 100%"}},"987f1ae36a1e4ed780b6f3eb06c306a9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_9d495e8aded74de191176894b850dc1b","max":456318,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ea4e363e64c148b09f9821ff3f719319","value":456318}},"3cd267c247f943daa086417456b3ba73":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f0e2cde49cb64aae9aeb0f4313d483a0","placeholder":"​","style":"IPY_MODEL_8e38b4edb1e541ad90f01cb81ffc5086","value":" 456k/456k [00:00&lt;00:00, 2.17MB/s]"}},"4ac4623662934546a6989c0e98b7a3b0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"215405f937a94a07ab2ef8d04fae8e42":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"37d6c70a595e4782b540bc8bbb3f2a5c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9d495e8aded74de191176894b850dc1b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ea4e363e64c148b09f9821ff3f719319":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f0e2cde49cb64aae9aeb0f4313d483a0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8e38b4edb1e541ad90f01cb81ffc5086":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e73b7f5981b04cb39f1939c094321369":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_95587a5f7faf47d88aff5af8ed1dc418","IPY_MODEL_31d50da1a6ec4d8a8999bbf43ae4f9de","IPY_MODEL_cecfd887fb114033a18af900e5e8bf02"],"layout":"IPY_MODEL_20c3ac1bd3014ccbb1c07c6cb9a516a6"}},"95587a5f7faf47d88aff5af8ed1dc418":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3c22b25c524041eab6e6cd93dd2545f4","placeholder":"​","style":"IPY_MODEL_5b1b2d41631448cca77abd3fb9d201dc","value":"Downloading (…)cial_tokens_map.json: 100%"}},"31d50da1a6ec4d8a8999bbf43ae4f9de":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_23115440a6b74b7baa1b96c76ba29dab","max":357,"min":0,"orientation":"horizontal","style":"IPY_MODEL_078f6d71de3f4b29b327b8114b62ecbc","value":357}},"cecfd887fb114033a18af900e5e8bf02":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_651798ba7094450095ffacb3473be2ac","placeholder":"​","style":"IPY_MODEL_1e56c29b223c48d9aace13bb462a9e5b","value":" 357/357 [00:00&lt;00:00, 8.98kB/s]"}},"20c3ac1bd3014ccbb1c07c6cb9a516a6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3c22b25c524041eab6e6cd93dd2545f4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5b1b2d41631448cca77abd3fb9d201dc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"23115440a6b74b7baa1b96c76ba29dab":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"078f6d71de3f4b29b327b8114b62ecbc":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"651798ba7094450095ffacb3473be2ac":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1e56c29b223c48d9aace13bb462a9e5b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}},"gpuClass":"standard","accelerator":"GPU"},"cells":[{"cell_type":"markdown","source":["Mounting Drive and loading cleaned dataset"],"metadata":{"id":"GLjk7q0pMoRq"}},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7BkrOXbQ_622","executionInfo":{"status":"ok","timestamp":1687034551833,"user_tz":-120,"elapsed":24069,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"d2fcc494-7062-4f43-b8c5-a78e716c1682"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","source":["%cd \"drive/MyDrive/Nuans_Project\""],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Cju2rEeWAEHS","executionInfo":{"status":"ok","timestamp":1687034551833,"user_tz":-120,"elapsed":6,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"19324efa-70f5-4ae5-e07e-3ceb98d53f99"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/Nuans_Project\n"]}]},{"cell_type":"markdown","source":["Note: To add data files and model files"],"metadata":{"id":"YPYhz-fwzalo"}},{"cell_type":"code","source":["'''!pip install gdown\n","import gdown\n","gdown.download_folder(\"https://drive.google.com/drive/folders/1-0Lx97H_kQwUOt2S-mn6WWPAtEnVPDBh?usp=sharing\")\n","gdown.download_folder(\"https://drive.google.com/drive/folders/1VDXdNiUAIc8oUBL6xOFuo3rmvDxPmKLY?usp=sharing\")\n","gdown.download_folder(\"https://drive.google.com/drive/folders/1YQIGMkdOU-eVktlWDLO2DG9n5hxCn84e?usp=sharing\")\n","gdown.download_folder(\"https://drive.google.com/drive/folders/1vZbBsCawST8jbPrC1YtFBzYM6ZJYhTJ4?usp=sharing\")\n","gdown.download_folder(\"https://drive.google.com/drive/folders/1y3_Cs-i3GgP5miS8g9Z7ThIqdEcmJbzm?usp=sharing\")\n","\n","gdown.download(\"https://drive.google.com/uc?id=1Xhj-xqBcfFkHnCmVhU0Co_j_hu2iDtgd\")\n","gdown.download(\"https://drive.google.com/uc?id=1nAlHbfr75o0qTSy4D_B1keMSuQCDzCcj\")\n","gdown.download(\"https://drive.google.com/uc?id=1pxNfiUjKMHxDbHFuCPNDg01aGo0l-Fya\")\n","gdown.download(\"https://drive.google.com/uc?id=1s5g6UPYVYRLhJI_KubDa__h12YfBh2yM\")'''"],"metadata":{"id":"dYWBOtb2zW8b"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["!pip uninstall -y transformers accelerate\n","!pip install transformers accelerate"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rX6YnOVLTYbu","executionInfo":{"status":"ok","timestamp":1687034571263,"user_tz":-120,"elapsed":16697,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"fe6b13a5-304d-41a5-c44f-b7b876305e26"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[33mWARNING: Skipping transformers as it is not installed.\u001b[0m\u001b[33m\n","\u001b[0m\u001b[33mWARNING: Skipping accelerate as it is not installed.\u001b[0m\u001b[33m\n","\u001b[0mLooking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers\n","  Downloading transformers-4.30.2-py3-none-any.whl (7.2 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.2/7.2 MB\u001b[0m \u001b[31m69.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting accelerate\n","  Downloading accelerate-0.20.3-py3-none-any.whl (227 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m227.6/227.6 kB\u001b[0m \u001b[31m30.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.12.0)\n","Collecting huggingface-hub<1.0,>=0.14.1 (from transformers)\n","  Downloading huggingface_hub-0.15.1-py3-none-any.whl (236 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m236.8/236.8 kB\u001b[0m \u001b[31m34.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (1.22.4)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (23.1)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (6.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2022.10.31)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers) (2.27.1)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1 (from transformers)\n","  Downloading tokenizers-0.13.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m116.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting safetensors>=0.3.1 (from transformers)\n","  Downloading safetensors-0.3.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m70.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers) (4.65.0)\n","Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate) (5.9.5)\n","Requirement already satisfied: torch>=1.6.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (2.0.1+cu118)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers) (2023.4.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers) (4.5.0)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (1.11.1)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1.2)\n","Requirement already satisfied: triton==2.0.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (2.0.0)\n","Requirement already satisfied: cmake in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (3.25.2)\n","Requirement already satisfied: lit in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (16.0.5)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2022.12.7)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2.0.12)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.4)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.6.0->accelerate) (2.1.2)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch>=1.6.0->accelerate) (1.3.0)\n","Installing collected packages: tokenizers, safetensors, huggingface-hub, transformers, accelerate\n","Successfully installed accelerate-0.20.3 huggingface-hub-0.15.1 safetensors-0.3.1 tokenizers-0.13.3 transformers-4.30.2\n"]}]},{"cell_type":"code","source":["!pip install datasets"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"SV9PUHjzgNw5","executionInfo":{"status":"ok","timestamp":1687034591285,"user_tz":-120,"elapsed":20026,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"02796d51-4ae2-47f4-ce50-061ca5f1492e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting datasets\n","  Downloading datasets-2.13.0-py3-none-any.whl (485 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m485.6/485.6 kB\u001b[0m \u001b[31m21.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from datasets) (1.22.4)\n","Requirement already satisfied: pyarrow>=8.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (9.0.0)\n","Collecting dill<0.3.7,>=0.3.0 (from datasets)\n","  Downloading dill-0.3.6-py3-none-any.whl (110 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m110.5/110.5 kB\u001b[0m \u001b[31m16.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from datasets) (1.5.3)\n","Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (2.27.1)\n","Requirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (4.65.0)\n","Collecting xxhash (from datasets)\n","  Downloading xxhash-3.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (212 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m212.5/212.5 kB\u001b[0m \u001b[31m3.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting multiprocess (from datasets)\n","  Downloading multiprocess-0.70.14-py310-none-any.whl (134 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.3/134.3 kB\u001b[0m \u001b[31m19.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: fsspec[http]>=2021.11.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (2023.4.0)\n","Collecting aiohttp (from datasets)\n","  Downloading aiohttp-3.8.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.0 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.0/1.0 MB\u001b[0m \u001b[31m75.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: huggingface-hub<1.0.0,>=0.11.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (0.15.1)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from datasets) (23.1)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (6.0)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (23.1.0)\n","Requirement already satisfied: charset-normalizer<4.0,>=2.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (2.0.12)\n","Collecting multidict<7.0,>=4.5 (from aiohttp->datasets)\n","  Downloading multidict-6.0.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (114 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m114.5/114.5 kB\u001b[0m \u001b[31m18.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting async-timeout<5.0,>=4.0.0a3 (from aiohttp->datasets)\n","  Downloading async_timeout-4.0.2-py3-none-any.whl (5.8 kB)\n","Collecting yarl<2.0,>=1.0 (from aiohttp->datasets)\n","  Downloading yarl-1.9.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (268 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m268.8/268.8 kB\u001b[0m \u001b[31m32.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting frozenlist>=1.1.1 (from aiohttp->datasets)\n","  Downloading frozenlist-1.3.3-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (149 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m149.6/149.6 kB\u001b[0m \u001b[31m16.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting aiosignal>=1.1.2 (from aiohttp->datasets)\n","  Downloading aiosignal-1.3.1-py3-none-any.whl (7.6 kB)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0.0,>=0.11.0->datasets) (3.12.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0.0,>=0.11.0->datasets) (4.5.0)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (2022.12.7)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (3.4)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2022.7.1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.1->pandas->datasets) (1.16.0)\n","Installing collected packages: xxhash, multidict, frozenlist, dill, async-timeout, yarl, multiprocess, aiosignal, aiohttp, datasets\n","Successfully installed aiohttp-3.8.4 aiosignal-1.3.1 async-timeout-4.0.2 datasets-2.13.0 dill-0.3.6 frozenlist-1.3.3 multidict-6.0.4 multiprocess-0.70.14 xxhash-3.2.0 yarl-1.9.2\n"]}]},{"cell_type":"code","source":["!ls"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dPHnJ-bYALNu","executionInfo":{"status":"ok","timestamp":1684798423892,"user_tz":-120,"elapsed":1123,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"70547b8e-9a73-4236-a34c-a8fdf1df6a99"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":[" 6_genre_clean_training_data.txt   modelBloomtrail1\n"," 6_genre_eval_data.txt\t\t   modelBloomTtrail1\n"," bart-large-cnn\t\t\t   modelOpttrail1\n","'Cartella senza titolo'\t\t   modelOptTtrail1\n"," cleaneddf.csv\t\t\t   modelt5trail1\n"," data\t\t\t\t   new_model1gptneo\n"," dataset\t\t\t   new_model2gptneo\n"," drive\t\t\t\t   new_model3gptneo\n"," FAIRY_TALE\t\t\t   new_model4gptneo\n"," model\t\t\t\t   updated\n"," modelbarttrail1\t\t   wiki_movie_plots_deduped.csv\n"," modelBARTtrail2\t\t   wiki_movie_plots_deduped.gsheet\n"," modelberttrail1\n"]}]},{"cell_type":"code","source":["import pandas as pd\n","import numpy as np\n","import matplotlib.pyplot as plt\n","import seaborn as sns\n"],"metadata":{"id":"EqSMuL7rANjh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["dataset=pd.read_csv(\"cleaneddf.csv\")"],"metadata":{"id":"RcNdAToOATzp"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["dataset.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":204},"id":"mPPxPAdl4rHQ","executionInfo":{"status":"ok","timestamp":1684798425467,"user_tz":-120,"elapsed":5,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"1b23a3f4-3567-4f9c-eb63-9165ba92642c"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   Unnamed: 0  index   Genre  \\\n","0           0      7  comedy   \n","1           1     14  comedy   \n","2           2     15  comedy   \n","3           3     16   drama   \n","4           4     17   drama   \n","\n","                                                Plot  \n","0  <comedy>The film is about a family who move to...  \n","1  <comedy>Before heading out to a baseball game ...  \n","2  <comedy>The plot is that of a black woman goin...  \n","3  <drama>On a beautiful summer day a father and ...  \n","4  <drama>A thug accosts a girl as she leaves her...  "],"text/html":["\n","  <div id=\"df-ac809ce0-f8bf-4a95-b2b9-d5a08db071ba\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>index</th>\n","      <th>Genre</th>\n","      <th>Plot</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>7</td>\n","      <td>comedy</td>\n","      <td>&lt;comedy&gt;The film is about a family who move to...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>14</td>\n","      <td>comedy</td>\n","      <td>&lt;comedy&gt;Before heading out to a baseball game ...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>15</td>\n","      <td>comedy</td>\n","      <td>&lt;comedy&gt;The plot is that of a black woman goin...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>16</td>\n","      <td>drama</td>\n","      <td>&lt;drama&gt;On a beautiful summer day a father and ...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>17</td>\n","      <td>drama</td>\n","      <td>&lt;drama&gt;A thug accosts a girl as she leaves her...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ac809ce0-f8bf-4a95-b2b9-d5a08db071ba')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-ac809ce0-f8bf-4a95-b2b9-d5a08db071ba button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-ac809ce0-f8bf-4a95-b2b9-d5a08db071ba');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":7}]},{"cell_type":"code","source":["len(dataset)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"RrEY9-I0Aaq_","executionInfo":{"status":"ok","timestamp":1684798425467,"user_tz":-120,"elapsed":6,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"45d7a1ab-7f0f-488b-cf26-a8c2a2645ee7"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["13622"]},"metadata":{},"execution_count":6}]},{"cell_type":"code","source":["dataset.Genre.unique()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"nAZArdcoko81","executionInfo":{"status":"ok","timestamp":1684509208193,"user_tz":-120,"elapsed":10,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"24403b68-c766-4f29-df95-18795c498baa"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array(['western', 'comedy', 'short', ...,\n","       'adventure, romance, fantasy film', 'ero',\n","       'horror romantic comedy'], dtype=object)"]},"metadata":{},"execution_count":14}]},{"cell_type":"code","source":["#dataset = dataset.sample(frac=0.50)"],"metadata":{"id":"c8yARDiQyzYy"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["##FINE TUNING"],"metadata":{"id":"WsF6Avpli5R_"}},{"cell_type":"markdown","source":["Loading Tokenizer from Hugging Face"],"metadata":{"id":"LNmlMAL9MdOp"}},{"cell_type":"code","source":["from transformers import AutoTokenizer, GPTJForCausalLM\n","\n","tokenizer = AutoTokenizer.from_pretrained(\"EleutherAI/gpt-neo-125m\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":177,"referenced_widgets":["64238718ff864ba1a57cece073f35572","cfc206c5ae0d4c8db829fb0cf570e310","27b09f3f36014e658da4b9243a07c6c3","733a16946e2949c3b97572735d0c8637","99bf6f6c32934ed49c7af2924421cea0","cb3e2c68c4fd43a9ba1ad8bdbb6478a7","5d6d4b8cb5274161853e273408567023","903b4900f170450ca274bee5e2de47f9","1b6f13eabafd45148e169bc6dfeae4f5","4a4a4ae084df4b7db0c42c0729185c4e","3e50d98218324ea2afe68ac91e1400b1","b6b8681d13fa4c679fa4fe802ba80f61","e0d66106346b4c1f9cd606603ef38604","012499e39caa4e17ae91f12e16dc5f7a","37dc0ca4d8d0464cbf2f839b27533b3d","dba0be2b1b0848d1b2ac2826161bd360","5f2a75ccb4774a1293234425f0e139a4","43dfab340dda42e288f55085686411e0","6e597c9f552b4519995f1a288d1c83d5","26930e3d5d564cad8721c027944b4ad4","a1d575dd364748789984a9738aa63549","00081927c8714c00b11645a88b4d554f","14c29614ecb643e8b9de3e0f9d56293d","eac7b263c3924b919e231905fff1fd57","8ce63cef4f1b4e5ab6d1bb6727a58fd2","c2f19983884f4c2b8d8c66657e8f0460","62c4d318dc14459bb3f9b77b9b945029","d2a2c407cf3e4cf6adf0d04bbc9e175e","3126fdeddb144b9aa7169600fb54a030","2758fecdb260488ebf6472183d88df22","defeb12343aa455d8600aea32d599f86","ba5823ed41ee490ca041051a3497006a","b37967068b474b5aa89e135fa4394fc9","e04cf1b57a7d40039664e55c96359731","16b00df67ca942c48458fc871de2cbdd","987f1ae36a1e4ed780b6f3eb06c306a9","3cd267c247f943daa086417456b3ba73","4ac4623662934546a6989c0e98b7a3b0","215405f937a94a07ab2ef8d04fae8e42","37d6c70a595e4782b540bc8bbb3f2a5c","9d495e8aded74de191176894b850dc1b","ea4e363e64c148b09f9821ff3f719319","f0e2cde49cb64aae9aeb0f4313d483a0","8e38b4edb1e541ad90f01cb81ffc5086","e73b7f5981b04cb39f1939c094321369","95587a5f7faf47d88aff5af8ed1dc418","31d50da1a6ec4d8a8999bbf43ae4f9de","cecfd887fb114033a18af900e5e8bf02","20c3ac1bd3014ccbb1c07c6cb9a516a6","3c22b25c524041eab6e6cd93dd2545f4","5b1b2d41631448cca77abd3fb9d201dc","23115440a6b74b7baa1b96c76ba29dab","078f6d71de3f4b29b327b8114b62ecbc","651798ba7094450095ffacb3473be2ac","1e56c29b223c48d9aace13bb462a9e5b"]},"id":"hCRbbS4BLP8D","executionInfo":{"status":"ok","timestamp":1687034608963,"user_tz":-120,"elapsed":17680,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"7401371e-daee-4bb6-8e87-53ba1dd37bc2"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)okenizer_config.json:   0%|          | 0.00/560 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"64238718ff864ba1a57cece073f35572"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)lve/main/config.json:   0%|          | 0.00/1.01k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b6b8681d13fa4c679fa4fe802ba80f61"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)olve/main/vocab.json:   0%|          | 0.00/899k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"14c29614ecb643e8b9de3e0f9d56293d"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)olve/main/merges.txt:   0%|          | 0.00/456k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e04cf1b57a7d40039664e55c96359731"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)cial_tokens_map.json:   0%|          | 0.00/357 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e73b7f5981b04cb39f1939c094321369"}},"metadata":{}}]},{"cell_type":"markdown","source":["Adding Special Tokens and Loading Model from hugging face"],"metadata":{"id":"-wWDnud_MYA8"}},{"cell_type":"code","source":["from transformers import AutoConfig, AutoModelForCausalLM,AutoModelForSeq2SeqLM"],"metadata":{"id":"fAyaDAILLfkf"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["special_tokens_dict = {\n","        \"bos_token\": \"<BOS>\",\n","        \"eos_token\": \"<EOS>\",\n","        \"pad_token\": \"<PAD>\",\n","        \"additional_special_tokens\": [\n","            \"<superhero>\",\n","            \"<action>\",\n","            \"<drama>\",\n","            \"<thriller>\",\n","            \"<horror>\",\n","            \"<sci_fi>\",\n","            \"<comedy>\",\n","        ],\n","    }\n","\n","# the new token is added to the tokenizer\n","num_added_toks = tokenizer.add_special_tokens(special_tokens_dict)\n","\n","# the model config to which we add the special tokens\n","config = AutoConfig.from_pretrained('EleutherAI/gpt-neo-125m',\n","                                    bos_token_id=tokenizer.bos_token_id,\n","                                    eos_token_id=tokenizer.eos_token_id,\n","                                    pad_token_id=tokenizer.pad_token_id,\n","                                    output_hidden_states=False)\n","\n","# the pre-trained model is loaded with the custom configuration\n","base_model = AutoModelForCausalLM.from_pretrained(\"EleutherAI/gpt-neo-125m\", config=config)\n","\n","# the model embedding is resized\n","base_model.resize_token_embeddings(len(tokenizer))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":94,"referenced_widgets":["11e92175f2d143c6b19eed78950c58d2","8b3e381caef6437e862b1874b740b2d5","18506f48d8404ebb81151b9826a6d141","876801782aef42f59c941adf82b08da3","a319fb6ec3ed449a824adcfde82c58a2","690dfedb819e44f2bc96f6fd82ed11ff","9a2879717804461cb2564c7a93b279f1","60a9b952b9834be7b79549f4fda3e5dd","6bf8dbac6e0c417f8d37e9379b6448d2","54960193cbb24d1ba1d4496384931023","3ca7e026c858491096e471ddc48cd745"]},"id":"obw2zNCjiuum","outputId":"db3b8dfe-ebf7-42ec-dbf4-27bf793c9601","executionInfo":{"status":"ok","timestamp":1684798504513,"user_tz":-120,"elapsed":6270,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}}},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading pytorch_model.bin:   0%|          | 0.00/526M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"11e92175f2d143c6b19eed78950c58d2"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["Embedding(50267, 768)"]},"metadata":{},"execution_count":14}]},{"cell_type":"markdown","source":["Train_Test_Split"],"metadata":{"id":"zrH76BgQMUNQ"}},{"cell_type":"code","source":["from sklearn.model_selection import train_test_split"],"metadata":{"id":"LjSg9IyMObXj"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["dataset['Plot'] = special_tokens_dict['bos_token'] + ' ' + dataset['Plot'] + ' ' + special_tokens_dict['eos_token']\n","\n","df_train, df_val = train_test_split(dataset, train_size = 0.9, random_state = 77)\n","print(f'There are {len(df_train)} plots for training and {len(df_val)} for validation')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8HACaNkQjRmF","executionInfo":{"status":"ok","timestamp":1684798566197,"user_tz":-120,"elapsed":24,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"df957cc3-33da-464d-a7ef-61f01e56e9d7"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["There are 6129 plots for training and 682 for validation\n"]}]},{"cell_type":"code","source":["from datasets import Dataset"],"metadata":{"id":"W4Q92WWCO80J"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# we load the datasets directly from a pandas df\n","train_dataset = Dataset.from_pandas(df_train[['Plot']])\n","val_dataset = Dataset.from_pandas(df_val[['Plot']])"],"metadata":{"id":"vTgnU1u6j37o"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["Tokenizer Function"],"metadata":{"id":"3rlzYkm-MNdS"}},{"cell_type":"code","source":["def tokenize_function(examples):\n","        return tokenizer(examples['Plot'], add_special_tokens=True, truncation=True, padding=False)\n","\n","\n","tokenized_train_dataset = train_dataset.map(\n","    tokenize_function,\n","    batched=True,\n","    num_proc=5,\n","    remove_columns=['Plot'],\n",")\n","tokenized_val_dataset = val_dataset.map(\n","    tokenize_function,\n","    batched=True,\n","    num_proc=5,\n","    remove_columns=['Plot'],\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":17,"referenced_widgets":["1e579465835a4da580c8e5242a6de55f","514521ee680845b682f728686a0762a7","71ca771fff7940faba3aa515899cfabf","7554bf47f6484631b364e70e8f8ee59c","0589e1c9641940b9bad27dd8662601b5","e39d8e4104b04633955b13644e1f4f18","5120569113f2464bb86c8dcf6e5740cd","481ec9d786b846c2b407c3df88e5b519","d8673504c6bc4bcaa81d5e92739c63a8","ae26ceb92cd647c4b09364e98147dcb4","75ca1c84371b4a5e91802b02af2781ce","98ebbc1b976144cea657804eea449db4","7ad324a9c1934d6db777c36b03c79b09","69a73a3177b34983a59f89e3cfc08079","299b47aa16624b7aac6578c95d2b65c8","58ffde52ab4d43f4b7cc04a8caec7e15","d7db2b21f93842bb91f0f58c5a58d89c","0ec544ef40ea4cc5bd3eb8f5c3ec004a","8458c293946d45d59353ae9fbcc9f164","fd4c92f3b49749899e1219f631715ac5","34edc5319d214b8d9e860f0d510b9fa2","d87f3ed737ac4e7694d0cb361ad3b202"]},"id":"ZOHxAHWZkdLi","executionInfo":{"status":"ok","timestamp":1684798623802,"user_tz":-120,"elapsed":12264,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"ee542d90-eae6-43de-aab5-86c7a9906757"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Map (num_proc=5):   0%|          | 0/6129 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"1e579465835a4da580c8e5242a6de55f"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Map (num_proc=5):   0%|          | 0/682 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"98ebbc1b976144cea657804eea449db4"}},"metadata":{}}]},{"cell_type":"markdown","source":["Data Collator Object"],"metadata":{"id":"g6mjGWxvMJDo"}},{"cell_type":"code","source":["from transformers import DataCollatorForLanguageModeling"],"metadata":{"id":"8WP-zMYTQRqn"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["data_collator = DataCollatorForLanguageModeling(\n","        tokenizer=tokenizer,\n","        mlm=False\n","    )"],"metadata":{"id":"PPsmcblGkYgS"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from transformers import Trainer,TrainingArguments"],"metadata":{"id":"8kvbyhHoStJc"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#import os\n","#os.mkdir(\"new_model4gptneo23May\")"],"metadata":{"id":"pId9Xe7xYnEB"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["checkpoint = \"new_model2gptneo23May\"\n"],"metadata":{"id":"nMvPP6ZloT14"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["Loading the saved model"],"metadata":{"id":"yQOej3fTMGma"}},{"cell_type":"code","source":["model = AutoModelForCausalLM.from_pretrained(checkpoint)\n"],"metadata":{"id":"7d75ckDNRrKI"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["Training Parameters"],"metadata":{"id":"84y0ZRQPMAo_"}},{"cell_type":"code","source":["model_headlines_path = checkpoint\n","\n","training_args = TrainingArguments(\n","    output_dir=model_headlines_path,          # output directory\n","    num_train_epochs=1,              # total # of training epochs\n","    per_device_train_batch_size=1,  # batch size per device during training\n","    per_device_eval_batch_size=1,   # batch size for evaluation\n","    warmup_steps=20,                # number of warmup steps for learning rate scheduler\n","    weight_decay=0.01,               # strength of weight decay\n","    logging_dir=model_headlines_path,            # directory for storing logs\n","    prediction_loss_only=True,\n","    save_steps=500\n","\n",")"],"metadata":{"id":"cGmqYyBcn6aS"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["Training Object"],"metadata":{"id":"3zm_N7bxL-Mm"}},{"cell_type":"code","source":["trainer = Trainer(\n","    model=base_model,                         # the instantiated 🤗 Transformers model to be trained\n","    args=training_args,                  # training arguments, defined above\n","    data_collator=data_collator,\n","    train_dataset=tokenized_train_dataset,         # training dataset\n","\n",")\n","trainer.train()\n","trainer.save_model()\n","tokenizer.save_pretrained(model_headlines_path)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":222},"id":"Lfoec0BJnyrp","outputId":"ac941b3e-9aa4-48b2-95fb-ec0353eb82d1"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:407: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='1948' max='6129' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [1948/6129 08:01 < 17:15, 4.04 it/s, Epoch 0.32/1]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>500</td>\n","      <td>5.224100</td>\n","    </tr>\n","    <tr>\n","      <td>1000</td>\n","      <td>5.214400</td>\n","    </tr>\n","    <tr>\n","      <td>1500</td>\n","      <td>5.204800</td>\n","    </tr>\n","  </tbody>\n","</table><p>"]},"metadata":{}}]},{"cell_type":"code","source":["from transformers import pipeline\n","from transformers.pipelines.pt_utils import KeyDataset\n","from tqdm.auto import tqdm"],"metadata":{"id":"HTcBn4jBGchh"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["Function for generating movie plots"],"metadata":{"id":"QIzizfy8L3HH"}},{"cell_type":"code","source":["def generate_n_text_samples(model, tokenizer, input_text, device, n_samples):\n","    text_ids = tokenizer.encode(input_text, return_tensors = 'pt')\n","    text_ids = text_ids.to(device)\n","    model = model.to(device)\n","\n","    generated_text_samples = model.generate(\n","        text_ids,\n","        max_length= 200,\n","        num_return_sequences= n_samples,\n","        no_repeat_ngram_size= 2,\n","        repetition_penalty= 1.5,\n","        top_p= 0.92,\n","        temperature= .85,\n","        do_sample= True,\n","        top_k= 125,\n","        early_stopping= True\n","    )\n","    gen_text = []\n","    for t in generated_text_samples:\n","        text = tokenizer.decode(t, skip_special_tokens=True)\n","        gen_text.append(text)\n","\n","        return gen_text\n"],"metadata":{"id":"_grzvixSLLSu"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import nltk\n","from nltk.translate.bleu_score import sentence_bleu\n","\n","def calculate_self_bleu(stories):\n","    self_bleu_scores = []\n","\n","    for story in stories:\n","        segments = story.split(\".\")  # Split the story into segments (e.g., by newline)\n","        print(segments)\n","        bleu_scores = []\n","\n","        for i in range(len(segments)):\n","            reference = segments[:i] + segments[i+1:]  # Remove the current segment as reference\n","\n","            hypothesis = segments[i]\n","\n","            bleu_scores.append(sentence_bleu(reference, hypothesis))\n","\n","        self_bleu_scores.append(sum(bleu_scores) / len(bleu_scores))\n","\n","    average_self_bleu = sum(self_bleu_scores) / len(self_bleu_scores)\n","    return average_self_bleu\n","\n"],"metadata":{"id":"ViagC7Q2KoJE"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from transformers import AutoTokenizer"],"metadata":{"id":"MOCy6EERDSVh"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["RESULTS: 0 and Its Self-BLEU Score"],"metadata":{"id":"EBS19DTKb9V8"}},{"cell_type":"code","source":["model = AutoModelForCausalLM.from_pretrained(checkpoint)\n","tokenizer = AutoTokenizer.from_pretrained(checkpoint)\n","input_prompt = \"<BOS> <superhero> Batman tries to save Gotham\"\n","device = \"cuda:0\"\n","\n","headlines = generate_n_text_samples(model, tokenizer,\n","                                    input_prompt, device,n_samples = 1)\n"],"metadata":{"id":"AhakzjCFFmvQ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["for h in headlines:\n","    print(h)\n","    print(\"\\n\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8TjXWozvGvfw","executionInfo":{"status":"ok","timestamp":1687036032308,"user_tz":-120,"elapsed":5,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"92f1837e-f5d0-4c1e-e54c-fb700a9a88db"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["  Batman tries to save Gotham City's best friend, but she is interrupted by a local men and he finds it only for him. After getting married and tries with the two-year-old brother (the girl) goes off in order to buy several days, who has become an ambulance of a small village from some people' person for one where they meet, he encounters them on his own marriage. The three are taken over as a gangsters and the life.\r\n","When he meets Dollinezorsings and realizes that not like a new teacher is later that if the children will be a romantic affair and are killed at front with him into it is. When you want to find themselves to prove her to get into jail that their relationship but also turns out of Paris, no important when Harry insists is then take part in love. She sets of having heard the couple, only is to join, leaving him to help everyone. In two have been having sex-lost father\n","\n","\n"]}]},{"cell_type":"code","source":["generated_stories = headlines\n","self_bleu_score = calculate_self_bleu(generated_stories)\n","print(\"Self-BLEU score:\", self_bleu_score)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cdZeIP3PLqF7","executionInfo":{"status":"ok","timestamp":1687036032308,"user_tz":-120,"elapsed":4,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"6e82af9b-1baa-4d98-e5f5-d9a7cd4aeeb1"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[\"  Batman tries to save Gotham City's best friend, but she is interrupted by a local men and he finds it only for him\", \" After getting married and tries with the two-year-old brother (the girl) goes off in order to buy several days, who has become an ambulance of a small village from some people' person for one where they meet, he encounters them on his own marriage\", ' The three are taken over as a gangsters and the life', '\\r\\nWhen he meets Dollinezorsings and realizes that not like a new teacher is later that if the children will be a romantic affair and are killed at front with him into it is', ' When you want to find themselves to prove her to get into jail that their relationship but also turns out of Paris, no important when Harry insists is then take part in love', ' She sets of having heard the couple, only is to join, leaving him to help everyone', ' In two have been having sex-lost father']\n","Self-BLEU score: 0.526194430976089\n"]}]},{"cell_type":"markdown","source":["\n","\n","RESULTS: 1 and Its Self-BLEU Score"],"metadata":{"id":"FNtTPa4eLjUs"}},{"cell_type":"code","source":["input_prompt = \"<BOS> <action> Agent\"\n","#input_text = tokenizer.bos_token\n","device = \"cuda:0\"\n","\n","headlines = generate_n_text_samples(model, tokenizer,\n","                                    input_prompt, device, n_samples = 1)\n"],"metadata":{"id":"i5wg1h82MKeW"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["for h in headlines:\n","    print(h)\n","    print(\"\\n\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"48hbHpzxfvwT","executionInfo":{"status":"ok","timestamp":1687035546234,"user_tz":-120,"elapsed":22,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"6ac0ddea-ba4a-4a9d-dc4f-1022be75e729"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["<BOS> <action> Agent Tingle and his girlfriend, Maggie Blakeley (Clairee Daley), are hired by a former lover to go out on an affair. Their job is going through the making of the film that's been set in an antique shop window. Fearing their love, the girl goes off with Maggie's boyfriend Jim Brown-Hugh (Richard \"Jim\" Brown). She must have him at her house where she needs to collect all he can handle - which will be used as evidence for being responsible for the crime done during the gangster era. They take it to each other but then them and move off to the next street where they come across people like Jim's friends - who was once again using Maggie as bait in the past when he has had Jim with whom he could get pregnant. The next Packagebenefit:The film says up a judge from the relationship.\r\n","If Gona shows off from a money. His daughter Lee, causing the\n","\n","\n"]}]},{"cell_type":"code","source":["generated_stories = headlines\n","self_bleu_score = calculate_self_bleu(generated_stories)\n","print(\"Self-BLEU score:\", self_bleu_score)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"U2Oi7oLOKt2O","executionInfo":{"status":"ok","timestamp":1687035768059,"user_tz":-120,"elapsed":444,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"4b221628-883b-499d-f857-f7e4b8235825"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["['<BOS> <action> Agent Tingle and his girlfriend, Maggie Blakeley (Clairee Daley), are hired by a former lover to go out on an affair', \" Their job is going through the making of the film that's been set in an antique shop window\", ' Fearing their love, the girl goes off with Maggie\\'s boyfriend Jim Brown-Hugh (Richard \"Jim\" Brown)', ' She must have him at her house where she needs to collect all he can handle - which will be used as evidence for being responsible for the crime done during the gangster era', \" They take it to each other but then them and move off to the next street where they come across people like Jim's friends - who was once again using Maggie as bait in the past when he has had Jim with whom he could get pregnant\", ' The next Packagebenefit:The film says up a judge from the relationship', '\\r\\nIf Gona shows off from a money', ' His daughter Lee, causing the']\n","Self-BLEU score: 0.4993983718166928\n"]}]},{"cell_type":"markdown","source":["RESULTS: 2 and Its Self-BLEU Score"],"metadata":{"id":"ews4nM9YLgHQ"}},{"cell_type":"code","source":["input_prompt = \"<BOS> <comedy> Sandesh\"\n","#input_text = tokenizer.bos_token\n","device = \"cuda:0\"\n","\n","headlines = generate_n_text_samples(model, tokenizer,\n","                                    input_prompt, device, n_samples = 1)\n"],"metadata":{"id":"YfZBQ1ikfz4M"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["for h in headlines:\n","    print(h)\n","    print(\"\\n\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"19-MKQVef9U4","executionInfo":{"status":"ok","timestamp":1687035840018,"user_tz":-120,"elapsed":22,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"d79e1d75-2971-4c74-9f2b-2355f9d64503"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["<BOS> <comedy> Sandesh alias Ashok is seen by Raghu, a TV producer working in the industry. His wife Chawla marries him and they flee their father's business village to marry another man who has money but his name does not belong. They decide to visit a beautiful woman named Baba (Shiva), whose beauty tells them she comes of bad luck for her to-day. He forces himself on duty when he witnesses this scene: Ramesh (Nagadirani) comes into the house where Naggarajya, living happily with two close couples while his sister lives alone. In the next day Rameadhikari gets drunk up and leaves the bathroom so that N Agalandi becomes ill. Soon Rajnagar falls away from Ramaiah, the daughter of a wealthy man. All goes well as it was about NAgalamali about marrying Kotaanuri Mohi.[3] Now Rannam\n","\n","\n"]}]},{"cell_type":"code","source":["generated_stories = headlines\n","self_bleu_score = calculate_self_bleu(generated_stories)\n","print(\"Self-BLEU score:\", self_bleu_score)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"QSKVmfoILGGw","executionInfo":{"status":"ok","timestamp":1687035866221,"user_tz":-120,"elapsed":2,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"9c107957-8d4e-4e5f-8743-00a4d4ac68e4"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["['<BOS> <comedy> Sandesh alias Ashok is seen by Raghu, a TV producer working in the industry', \" His wife Chawla marries him and they flee their father's business village to marry another man who has money but his name does not belong\", ' They decide to visit a beautiful woman named Baba (Shiva), whose beauty tells them she comes of bad luck for her to-day', ' He forces himself on duty when he witnesses this scene: Ramesh (Nagadirani) comes into the house where Naggarajya, living happily with two close couples while his sister lives alone', ' In the next day Rameadhikari gets drunk up and leaves the bathroom so that N Agalandi becomes ill', ' Soon Rajnagar falls away from Ramaiah, the daughter of a wealthy man', ' All goes well as it was about NAgalamali about marrying Kotaanuri Mohi', '[3] Now Rannam']\n","Self-BLEU score: 0.36701613830642005\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/nltk/translate/bleu_score.py:552: UserWarning: \n","The hypothesis contains 0 counts of 4-gram overlaps.\n","Therefore the BLEU score evaluates to 0, independently of\n","how many N-gram overlaps of lower order it contains.\n","Consider using lower n-gram order or use SmoothingFunction()\n","  warnings.warn(_msg)\n"]}]},{"cell_type":"markdown","source":["RESULTS: 3 and Its Self-BLEU Score"],"metadata":{"id":"aka4L-qyLVbX"}},{"cell_type":"code","source":["input_prompt = \"<BOS> <drama> Brad pitt\"\n","#input_text = tokenizer.bos_token\n","device = \"cuda:0\"\n","\n","headlines = generate_n_text_samples(model, tokenizer,\n","                                    input_prompt, device, n_samples = 1)\n"],"metadata":{"id":"ALmTorgYgCnF"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["for h in headlines:\n","    print(h)\n","    print(\"\\n\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7-M3KWxYjPW0","executionInfo":{"status":"ok","timestamp":1687035891474,"user_tz":-120,"elapsed":21,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"298c9db2-915d-4883-ea32-c3454e0b04b8"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["<BOS> <drama> Brad pitt is a writer who makes a living in London. His mother Emily (Cheryl Parker) works as a bookkeeper at the bank, but she herself runs into an abusive fiancée named Elizabeth (Annus Lawrence), so that her children are forced to leave school and travel far away from home. After being rejected by John Clegg's manager, Emily is eager for work as well: \"During college they'd be able to get married on two different nights because of it... You'd have better luck than when you can't eat or sleep.\" While she has managed to run over him, she rejects being without food.\r\n","Edith Pudler becomes increasingly irritated with Emily as her lover when he witnesses her being adopted. The relationship between them threatens to take another turn. She tries to convince Philip (played by the playboy, played by Lewis Carroll), to inform a girl that Edith wants the couple's marriage to be\n","\n","\n"]}]},{"cell_type":"code","source":["# Example usage\n","generated_stories = headlines\n","self_bleu_score = calculate_self_bleu(generated_stories)\n","print(\"Self-BLEU score:\", self_bleu_score)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"BAl3ZTdkLKKK","executionInfo":{"status":"ok","timestamp":1687035898774,"user_tz":-120,"elapsed":411,"user":{"displayName":"saud hussain","userId":"14628660618575709689"}},"outputId":"1ac72625-bbff-4960-b752-a209ef17ebf8"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["['<BOS> <drama> Brad pitt is a writer who makes a living in London', ' His mother Emily (Cheryl Parker) works as a bookkeeper at the bank, but she herself runs into an abusive fiancée named Elizabeth (Annus Lawrence), so that her children are forced to leave school and travel far away from home', ' After being rejected by John Clegg\\'s manager, Emily is eager for work as well: \"During college they\\'d be able to get married on two different nights because of it', '', '', \" You'd have better luck than when you can't eat or sleep\", '\" While she has managed to run over him, she rejects being without food', '\\r\\nEdith Pudler becomes increasingly irritated with Emily as her lover when he witnesses her being adopted', ' The relationship between them threatens to take another turn', \" She tries to convince Philip (played by the playboy, played by Lewis Carroll), to inform a girl that Edith wants the couple's marriage to be\"]\n","Self-BLEU score: 0.37882636232587\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"nHjvs3hUPgmb"},"execution_count":null,"outputs":[]}]}